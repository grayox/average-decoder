//-------------------------------------- Code.gs --------------------------------------
// JSON visualization | viewer: http://chris.photobooks.com/json/default.htm
// function getEmailQuota(){Logger.log("Remaining email quota: " + MailApp.getRemainingDailyQuota());}
// Note: to accept doPost() from affiliate, (design decision:) must set: Publish > Deploy as web app > Execute the app as: me, Who has access to the app: Anyone, even anonymous // Otherwise, script will not run at server (though, client will receive responseCode=200); client response (200) is Google accounts sign-in page/form  // Decision Benefits: 1. script runs 2. script authorization bypass (i.e., not needed at UI) // Decision Costs: 1. Looser script security; mitigated by a. Site level access restrictions/permissions b. key method (e.g., switch/case k:foo)
function auth    (){}
function timer   (){Logger.log(new Date().getTime())}//1388228703613
function backup  (){var desc="NoteExchange™ Backup — timestamp:"+new Date().getTime(),id,out=[],db=ScriptDb.getMyDb(),results=db.query({});while(results.hasNext()){out.unshift(results.next())}id=DriveApp.createFile(desc,JSON.stringify(out),MimeType.HTML).setDescription(desc);Logger.log(id);}
function print   (){var desc="NoteExchange™ Print — timestamp:"+new Date().getTime(),id,out=[],db=ScriptDb.getMyDb(),results=db.query({table:"note"});while(results.hasNext()){out.unshift(results.next())}id=DriveApp.createFile(desc,JSON.stringify(out),MimeType.HTML).setDescription(desc);Logger.log(id);}
function size    (){var db=ScriptDb.getMyDb();Logger.log(/*ScriptDb.getMyDb()*/db.query({table:"note"/*,k:"36sgd2m257w2j0sn5isa"/*,* /"3w34xo2xeuyy8jprgmzg"/ *,* /"8u0hjrtbd68s3hi1w9kl"/*,* /timestamp_posted:db.greaterThan(1388548425377)/*"bid"/*"user",seller:true,user:"atlaslive@gmail.com"*/}).getSize());}
function showById(){Logger.log(JSON.stringify(ScriptDb.getMyDb().load("S96280679164")))} // Show one record by ID
function showOne (){Logger.log(/*Utilities.jsonStringify*/JSON.stringify(ScriptDb.getMyDb().query({item:"eXjKqn1"/*/table:"note"/* /"user",user:"atlaslive@gmail.com",seller:true/*,city:"test"*/}).next()));} // Show all records in database // Reference: https://developers.google.com/apps-script/scriptdb#saving_data
function showAll (){var db=ScriptDb.getMyDb(),arr=[],r,results=db.query({table:"note"/*k:"8u0hjrtbd68s3hi1w9kl",/*"3w34xo2xeuyy8jprgmzg",/*"36sgd2m257w2j0sn5isa",/* /table:db.not("report"),timestamp_posted:db.greaterThan(1388548425377)/*"bid"/* /"user"/* /"note"/*,source:"fciEx"/*,seller:true,user:"atlaslive@gmail.com"*/});while(results.hasNext()){r=results.next();arr.push(r)}Logger.log(JSON.stringify(arr));return arr} // Show all records in database // Reference: https://developers.google.com/apps-script/scriptdb#saving_data
function print2ss(){LibraryjsUtil.write2ss(true,showAll(),"Sheet1","1azZ5rq1Sgy2fipwhwd75f9M6jkzvWk4TZmOzH2A4uRg"/*act*/)}
//function del     (){var xdb=ScriptDb.getMyDb(),arr=[],r,results=db.query({xtable:"note"/*,/*source:"fciEx_foo",* /table:db.not("report"),* /timestamp_posted:db.greaterThan(1388548425377),k:"8u0hjrtbd68s3hi1w9kl",/*"36sgd2m257w2j0sn5isa",* /"report"/* /"bid"/*"user"* /,xcity:"test"/*xseller:true,xuser* /,bidder:"atlaslive@gmail.com"*/});while(results.hasNext()){arr.push(results.next().getId());}db.removeByIdBatch(arr,false);} // Replaced: while(results.hasNext()){r=results.next();db.remove(r);}}
//function mod     (){var xdb=ScriptDb.getMyDb(),arr=[],r,results=db.query({/*item* /city:true,/*db.not(db.anyValue())/*/xtable:"note"/*,pctLtv:db.between(0,1.1),lienPos:db.not(1)/*,/*use* /lienPos:db.anyOf(["1st"/*false,db.not(db.anyValue())/*"Hospitality"/*"Commercial"/*"Apt","Multifamily"* /])/*"Oth"/* /"bid"*/});while(results.hasNext()){r=results.next();try{r.pctLtv=Math.round(100*r.balCur/r.estValue)}catch(e){r.pctLtv="";Logger.log(e.message)}/*r.lienPos=1;/*LibraryjsUtil.stateConvert(r.state,"abbr");/*.use="X";/*"CRE";/*"MUL";/*r.city=LibraryjsUtil.toCaseTitle(r.city);/*r.item=LibraryjsUtil.toBase62(Number(r.getId().slice(1)));/*if(r.askPrice==""){r.askPrice=0}/* /r.remove=false;r.accepted=false;/*r.askRate=r.buyRate;r.askPrice=r.buyPts;* /r.bids=[];/*r.table="note";r.datePosted=new Date().getTime();* /var i=r.bids.length;while(i--){/*r.bids[i].timestamp=r.bids[i].time;* /r.bids[i].accepted=false;/*r.bids[i].target_id=r.getId();* /r.bids[i].time=""/* /if(r.bids[i].bidder=="atlaslive@gmail.com"){r.bids.splice(i,1)}* /db.save(r);*/arr.push(r);}db.saveBatch(arr,false)}
function doPost (e){ // function xdoPost(e){return ContentService.createTextOutput("Hello World"/*"User says: "+JSON.stringify(e)*/)} // e.postData.getDataAsString()
    if(e && e.parameter && e.parameter.k){var k=e.parameter.k,m=e.parameter.m,p=e.parameter;switch(k){
            case   /* receive from fci */ "36sgd2m257w2j0sn5isa" : return receiveScrape (p,"fciEx"     ) ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* receive from nmp */ "3w34xo2xeuyy8jprgmzg" : return receiveScrape (p,"noteMktPl" ) ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* receive from ml  */ "8u0hjrtbd68s3hi1w9kl" : return receiveScrape (p,"moolahList") ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
         default                                                 :                                       ; break;}}}
// function xdoGet (e){return ContentService.createTextOutput("Hello World")}
   function  doGet (e){ // References: https://developers.google.com/apps-script/guides/html-service-communication#private_functions // https://sites.google.com/site/appsscripttutorial/miscellaneous/creating-form-elements-dynamically-using-google-apps-script-gas
 // if(e && e.parameter && e.parameter.jsoncallback){return ContentService.createTextOutput("foo({result:'<strong>Hello World'});").setMimeType(ContentService.MimeType.TEXT);}
    if(e && e.parameter && e.parameter.k){var k=e.parameter.k,m=e.parameter.m,p=e.parameter;switch(k){
            case   /* account     	   */ "uaceyes6ubt0nc4ow6ng" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bz-QzShfbx4/Uddv4FBoplI/AAAAAAAAHaM/iFNaaL5RB9M/s1600/My-Documents-icon.png\"                                                                 ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* taxdocs		   */ "qcy0zn273yllnor7daj7" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bz-QzShfbx4/Uddv4FBoplI/AAAAAAAAHaM/iFNaaL5RB9M/s1600/My-Documents-icon.png\"                                                                 ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* citizen-us	   */ "hcx6ce5fj22c0ru0uh7k" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bz-QzShfbx4/Uddv4FBoplI/AAAAAAAAHaM/iFNaaL5RB9M/s1600/My-Documents-icon.png\"                                                                 ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* citizen-nonus	   */ "1w6qu34iki6orhn31va9" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bz-QzShfbx4/Uddv4FBoplI/AAAAAAAAHaM/iFNaaL5RB9M/s1600/My-Documents-icon.png\"                                                                 ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* deals			   */ "2a6ib6wqih1po8amk9kp" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bz-QzShfbx4/Uddv4FBoplI/AAAAAAAAHaM/iFNaaL5RB9M/s1600/My-Documents-icon.png\"                                                                 ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* balances         */ "23gd3r4v88h0qs5l904w" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* tax-instructions */ "2632vy7qroae9ehameno" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* w9-eSign		   */ "eii2t8p9pj21o812ondu" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* w8-eSign		   */ "ahbcktn71r40oq5o6vut" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* training-manual  */ "tn46yr3m8dovd8pyfzl2" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<iframe style=\"xmargin-top:-200px;width:100%;height:100%\" src=\"https://docs.google.com/document/d/1tPoD_SKBc0ofqvaORp2ldbmKzT6s5cqnPOP81Pq1zk8/preview\"                                                                         ></iframe>      '})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* w9-pdf		   */ "rcgrp03ur0omffihy6h7" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<iframe style=\"xmargin-top:-200px;width:100%;height:100%\" src=\"http://www.irs.gov/pub/irs-pdf/fw9.pdf\"                                                                                                                          ></iframe>      '})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* w8-pdf           */ "ydl609qvq0eacb4ntbut" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<iframe style=\"xmargin-top:-200px;width:100%;height:100%\" src=\"http://www.irs.gov/pub/irs-pdf/fw8ben.pdf\"                                                                                                                       ></iframe>      '})").setMimeType(ContentService.MimeType.JSON      );break;
            case   /* register-buyer   */ "fruif01iaqqdgmqq1glu" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/dealdiggeronline/parties/buyer/register-buyer#sites-canvas-main-content\"      ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* private-listing  */ "bim5yiet1iw5m6ey33zr" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* private-auction  */ "zllhi2v8cx7qre66q3z2" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"margin-left:50px;margin-top:50px;\"><img src=\"https://lh4.googleusercontent.com/-bTaY-umWq04/UKVWnKQq5-I/AAAAAAAAD3s/dDtgQsquOD4/s1600/Under-Construction.jpg\"                                                                ></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
         // case   /* public-listing   */ "cdl2t4npt1vpu0ukq7xw" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/dealdiggeronline/parties/buyer/public-listing#sites-canvas-main-content\"      ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
         // case   /* public-auction   */ "3k6d9487bgr6tc4h6cbl" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"http://jsfiddle.net/Ynp5Z/6/show\"                                                                           ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
         // case   /* public-auction   */ "3k6d9487bgr6tc4h6cbl" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/dealdiggeronline/parties/buyer/public-auction#sites-canvas-main-content\"      ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* listings         */ "904dtdwo1rqyjaw5spjf" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/dealdiggeronline/parties/buyer/listings#sites-canvas-main-content\"            ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* auctions         */ "nbzuuuhxzxkkn3ln32m4" : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/dealdiggeronline/parties/buyer/auctions#sites-canvas-main-content\"            ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* pri-auc-data     */ "i2k7yas4a0t32cxw42v6" : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(privateAuction2      ( )) + ")"                                                                                                                                                                                                                 ).setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* serve sellers    */ "ipkqkho9pnhe6yfvl4bt" : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(serveSellers         ( )) + ")"                                                                                                                                                                                                                 ).setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* serve buyers     */ "bhn5yy2m1ngvdo018j2k" : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(serveBuyers          ( )) + ")"                                                                                                                                                                                                                 ).setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* serve calendar   */ "l1hhcu5citwws2377dtt" : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(serveCalendar        ( )) + ")"                                                                                                                                                                                                                 ).setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* serve marquee    */ "rv8eqwuvdm11f66c431g" : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(serveMarquee         ( )) + ")"                                                                                                                                                                                                                 ).setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* charts+graphs    */ "5cj78pfwd7emfl6nk6xq" : return                                                                               dataTableConstructor ( )                                                                                                                                                                                                                                                                            ;break; // for table constructor
            case   /* receive buy      */ "mkqwi0w4kvmm51spgrs9" : return                                                                   /* x.y() */ receiveBuy           (p) /*If fails in future, copy/paste set MimeType.JAVASCRIPT from DealDigger; remember to paste command line pre (i.e., "ContentService...") and post (MimeType.JAVASCRIPT) function call */                                                                                   ;break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* seller remove    */ "346f7w5jalx8cdwsfc2d" : return                                                                   /* x.y() */ receiveSell          (p)                                                                                                                                                                                                                                                                            ;break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* seller accept    */ "8u0ghdqoe4bw7ypepi0e" : return                                                                   /* x.y() */ receiveSell          (p)                                                                                                                                                                                                                                                                            ;break;
            case   /* receive report   */ "nwt0px9x22db4i03eod1" : return                                                                   /* x.y() */ receiveReport        (p)                                                                                                                                                                                                                                                                            ;break;
            case   /* Serve script JS  */ "k7fvbixefxcc1fy4eqr5" : return ContentService.createTextOutput(                                              serveScript          (k)                                                                                                                                                                                                                           ).setMimeType(ContentService.MimeType.JAVASCRIPT);break;         
            case   /* Serve script CSS */ "rcc6brjymslc37vtpb8y" : return ContentService.createTextOutput(e.parameter.    callback+"(" +                serveScript          (k)  + ")"                                                                                                                                                                                                                    ).setMimeType(ContentService.MimeType.JSON      );break;         
         // case   /* Test  script     */ "ilrav3er4xwaoejqezt2" : return ContentService.createTextOutput(                                               testScript          ( )                                                                                                                                                                                                                           ).setMimeType(ContentService.MimeType.JAVASCRIPT);break;         
         /* case   /* reports-dash    * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/gosalespro/manage/dashboard#sites-canvas-main-content\"                        ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* sp-dashboard    * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"no\"   style=\"xmargin-top:-200px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/gosalespro/manage/dashboard#sites-canvas-main-content\"                        ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            // Pages below this line do respond to the # anchor for <iframe> but we use negative margins to enable scrolling while limiting to top edge
            case   /* bugs-features   * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"auto\" style=\" margin-top:-240px;width:100%;height:1500px;\" src=\"https://sites.google.com/site/gosalespro/manage/bugs-features\"                                              ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
			// Pages below this line do not respond to # anchor for <iframe> so we used negative margins which also limit scrolling above top edge
            case   /* registration-sp * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"auto\" style=\" margin-top:-150px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/gosalespro/team/sp/apply#sites-canvas-main-content\"                           ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            case   /* objectives      * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"auto\" style=\" margin-top:-250px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/gosalespro/manage/objectives#sites-canvas-main-content\"                       ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
			case   /* announcements   * / "                    " : return ContentService.createTextOutput(e.parameter.jsoncallback+"({'result':'<div style=\"overflow:hidden\"><iframe scrolling=\"auto\" style=\" margin-top:-180px;width:100%;height:1200px;\" src=\"https://sites.google.com/site/gosalespro/admin/announcements#sites-canvas-main-content\"                     ></iframe></div>'})").setMimeType(ContentService.MimeType.JSON      );break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
            // Data tables below this line.
            // Insert data tables here.
      */ default                                                 :                                                                                                         ;break;}}     
    if(SitesApp.getActivePage()){var pageName = SitesApp.getActivePage().getName();switch(pageName){
            case   "sell"                  : return HtmlService.createHtmlOutputFromFile("sell.html"            ).setSandboxMode(HtmlService.SandboxMode.NATIVE           );break;
            case   "buy"                   : return HtmlService.createHtmlOutputFromFile("buy.html"             ).setSandboxMode(HtmlService.SandboxMode.NATIVE           );break;
            case   "sandbox"               : return HtmlService.createHtmlOutputFromFile("sandbox.html"         ).setSandboxMode(HtmlService.SandboxMode.NATIVE           );break;
            case   "authorize"             : return authorize                           (                       )                                                          ;break;
         /* case   "wholesaler_search"     : return HtmlService.createHtmlOutputFromFile("wholesaler_search"    )                                                          ;break; // HtmlService.createHtmlOutput(UrlFetchApp.fetch("https://sites.google.com/site/itr5k9zw23yzmxuaf5nb399c0ywb98/home/gasDD_wholesaler_search.html").getContentText());}
            case   "loan-application"      : return HtmlService.createTemplateFromFile  ("loanApp"              )                                               .evaluate();break;
            case   "researcher"            : return HtmlService.createTemplateFromFile  ("researcher"           )                                               .evaluate();break; // Debug: {var t=HtmlService.createTemplateFromFile("researcher").evaluate();Logger.log(t.getCodeWithComments);return t;}
            case   "agent"                 : return agent                                                                                                                ();break;
            case   "demo"                  : return demo                                                                                                                 ();break;
            case   "inventory"             : return inventory                                                                                                            ();break;                                                                                                     
            case   "sandbox2"              : return HtmlService.createHtmlOutputFromFile("sandbox2"             ).setSandboxMode(HtmlService.SandboxMode.NATIVE           );break; // Reference: https://developers.google.com/apps-script/guides/html-service-caja#setsandboxmode
            case   "lender"                : return HtmlService.createTemplateFromFile  ("lender"               )                                               .evaluate();break;
            case   "buyer_foreclosure"     : return HtmlService.createTemplateFromFile  ("buyer_foreclosure"    )                                               .evaluate();break;
            case   "private-listing"       : return HtmlService.createTemplateFromFile  ("private-listing"      )                                               .evaluate();break;
            case   "public-listing"        : return HtmlService.createTemplateFromFile  ("public-listing"       )                                               .evaluate();break;
            case   "public-auction"        : return HtmlService.createTemplateFromFile  ("public-auction"       )                                               .evaluate();break;
         // case   "private-auction"       : return HtmlService.createTemplateFromFile  ("private-auction"      )                                               .evaluate();break; // This works. But we seek an upgrade to jqWidgets, jqxGrid
         // case   "private-auction"       : return HtmlService.createHtmlOutputFromFile("private-auction1"     )                                                          ;break; // NOT WORKING in html file; switched to iframe jsfiddle // Error message: Invalid script or HTML content: https://www.sites.google.com/site/iae2mptmwylnrbz8iesqwkq8nvousn/home/jqx-all.js?attredirects=0&d=1:29+70920 - 70939: Integer literal 3155378976000000000 doesn't fit in 51 bits https://www.sites.google.com/site/iae2mptmwylnrbz8iesqwkq8nvousn/home/jqx.base.css?attredirects=0&d=1:428+28 - 29: Expected ) not . https://www.sites.google.com/site/iae2mptmwylnrbz8iesqwkq8nvousn/home/jqx.base.css?attredirects=0&d=1:428+5 - 62: Skipping malformed content 
         // case   "private-auction"       : return privateAuction2                                                                                                      ();break; // Use jsonp to populate jqxGrid (jqWidgets data table)
            case   "register-buyer"        : return HtmlService.createHtmlOutputFromFile("register-buyer"       )                                                          ;break;
            case   "register-lender"       : return HtmlService.createHtmlOutputFromFile("register-lender"      )                                                          ;break;
            case   "register-agent"        : return HtmlService.createHtmlOutputFromFile("register-agent"       )                                                          ;break;
            case   "register-auctionAgent" : return HtmlService.createHtmlOutputFromFile("register-auctionAgent")                                                          ;break;
            case   "register-researcher"   : return HtmlService.createHtmlOutputFromFile("register-researcher"  )                                                          ;break;
            case   "register-attorney"     : return HtmlService.createHtmlOutputFromFile("register-attorney"    )                                                          ;break;
      */ default                           :                                                                                                                                break;}}}
function authorize(){return HtmlService.createHtmlOutput("<div align='center' style='color:#808080;font-family:verdana;color:orange;font-weight:bold;margin-top:15px;'>Authorization successful!<div style='color:#808080;font-size:smaller;font-weight:normal;'>You may now access all features</div><img src='https://lh5.googleusercontent.com/-a81AytXYq0Q/Umtn0FrFdhI/AAAAAAAAIyE/xCYArSNCR1k/s144/orange-check-mark.png' height='100'></div>")}
function processForm_receiveFundDocs(ob){var i,user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),q={table:"user",seller:true,user:user},r=db.query(q).next();
    if(!r){r=q;r.record=[];r.emailList={current:[],archive:[]};}r.record.unshift(ob);r.record[0].date=t;r.emailList.current.unshift((t+","+ob.emailListString).split(/[\s,]+/)); // function test(){Logger.log("foo bar, zap-foo, baz bat".split(/[\s,]+/))} // Search term: split string by commar or space // Reference: http://stackoverflow.com/questions/1835032/regexp-split-string-by-commas-and-spaces-but-ignore-hyphenated-words
    i=r.emailList.current[0].length;while(i---1){if(r.emailList.archive.indexOf(r.emailList.current[i])==-1){r.emailList.archive.push(r.emailList.current[0][i])}}Logger.log(JSON.stringify(r));db.save(r)}
function processForm_registerSeller(ob){var i,user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),q={table:"user",seller:true,user:user},r=db.query(q).next();
    if(!r){r=q;r.record=[];r.emailList={current:[],archive:[]};}r.record.unshift(ob);r.record[0].timestamp=t;r.emailList.current.unshift((t+","+ob.emailListString).split(/[\s,]+/)); // function test(){Logger.log("foo bar, zap-foo, baz bat".split(/[\s,]+/))} // Search term: split string by commar or space // Reference: http://stackoverflow.com/questions/1835032/regexp-split-string-by-commas-and-spaces-but-ignore-hyphenated-words
    i=r.emailList.current[0].length;while(i---1){if(r.emailList.archive.indexOf(r.emailList.current[i])==-1){r.emailList.archive.push(r.emailList.current[0][i])}}Logger.log(JSON.stringify(r));db.save(r)}
function processForm_addNote(ob){var user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),u=db.query({table:"user",user:user,seller:true}).next(),i,dist=u.emailList.current[0].slice(1),site=SitesApp.getSite("onlinenoteexchange");if(!u.record[0].agreed){Logger.log(user+" did not agree to groundrules.");return}ob.table="note";ob.timestamp_posted=t;ob.seller=user;ob.remove=false;ob.accepted=false;ob.filePic=processPic(ob.filePic);ob.fileDoc=processDoc(ob.fileDoc);if(ob.askPrice==""){ob.askPrice=0};var id=db.save(ob).getId(),r=db.load(id);r.item=LibraryjsUtil.toBase62(Number(id.slice(1)));db.save(r);
    chromeLogoBlob=UrlFetchApp.fetch("https://lh5.googleusercontent.com/-zCLeer1r3ro/Udnn8thtnmI/AAAAAAAAHys/lWkaQnXPv_Q/s144/Google_Chrome_icon_2011.jpg").getBlob().setName("chromeLogoBlob");
    i=dist.length;while(i--){try{site.addViewer(dist[i])}catch(e){Logger.log(dist[i]+": "+e.message)}MailApp.sendEmail({to:dist[i],subject:"New loan: "+r.askRate+"%, "+r.askPrice+" points",htmlBody:("<a href='https://sites.google.com/site/onlinenoteexchange/buy'>Click here</a> (item: "+r.item+") <a href='https://www.google.com/intl/en/chrome/browser/'><img src='cid:chromeLogo' height='15' style='text-decoration:none;border:0;outline:none'></a> <a href='https://www.google.com/intl/en/chrome/browser/'>Chrome required</a>.<br><br>Rate: "+r.askRate+"% +"+r.askPrice+" points<br><br>Collateral:<br>"+r.sa+", "+r.city+", "+r.state+" "+r.zip+"<br>"+r.use+", "+r.beds+" beds, "+r.baths+" baths, "+r.sqft+" sqft, "+"<br><br>Loan Type: "+r.purpose+"<br>Unpaid Principal Balance: $"+r.balCur+"<br>Estimated Value: $"+r.estValue+"<br>LTV: "+r.pctLtv/*+"%<br>Term: "+r.term+" months<br>"*/+"<br>Highlights: "+r.notes),name:"atlaslive@gmail.com",inlineImages:{chromeLogo:chromeLogoBlob/*,youtubeLogo:youtubeLogoBlob*/}});}/*Logger.log(JSON.stringify(ob));*/return}
function sendUserToClient(){var user=Session.getActiveUser().getEmail(),u=ScriptDb.getMyDb().query({table:"user",seller:true,user:user}).next();/*Logger.log(JSON.stringify(r));*/return u;}
function processDoc(blob){try{var id=DocsList.createFile(blob/*.getAs("application/pdf")*/).getId();}catch(e){Logger.log("Error XpfAg: "+e.message);return "";}DriveApp.getFileById(id).setSharing(DriveApp.Access.ANYONE_WITH_LINK,DriveApp.Permission.VIEW);return DocsList.getFileById(id).getUrl();} // Reference: https://developers.google.com/apps-script/reference/base/composite-blob#getAs(String) // Reference: https://code.google.com/p/google-apps-script-issues/issues/detail?id=1660 see #37, Oct 13, 2012 // Use DocsList instead of DriveApp which will not allow document to be viewed properly
function processPic(blob){if(!blob.length){return ""}return "https://drive.google.com/uc?export=view&id="+DriveApp.createFile(blob/*.getAs("image/jpeg")*/).setSharing(DriveApp.Access.ANYONE_WITH_LINK,DriveApp.Permission.VIEW).getId()} // Image // Reference: http://stackoverflow.com/questions/10311092/displaying-files-e-g-images-stored-in-google-drive-on-a-website // http://stackoverflow.com/questions/14717426/referencing-project-files-with-html-service > http://googleappsdeveloper.blogspot.in/2012/11/announcing-google-drive-site-publishing.html
function receiveBuy(p){/*if((p.bidPrice=="")||(p.bidRate=="")){return} — Needs initial "" for first bid */Logger.log(JSON.stringify(p));var db=ScriptDb.getMyDb(),user=Session.getUser().getEmail(),t=new Date().getTime();p.db_id=LibraryjsUtil.rc4Decrypt("DktaE",p.db_id);var r=db.load(p.db_id);if(r.accepted||(r.remove||((r.askRate&&(p.bidRate<r.askRate))&&(r.askPrice&&(p.bidPrice<r.askPrice))))){return} // Bid rate OR pts CAN exceed ask to sweeten offer — but not BOTH
    if(r.bids==null){r.bids=[]}var accepted=((p.bidRate==r.askRate)&&(p.bidPrice==r.askPrice));r.bids.push({bidder:user,rate:p.bidRate,points:p.bidPrice,target_id:/*LibraryjsUtil.rc4Decrypt("vDMm0",r.getId())/*==*/p.db_id,timestamp:t,accepted:accepted});db.saveBatch([r,{table:"bid",target_id:/*LibraryjsUtil.rc4Decrypt("vDMm0",*/p.db_id/*==r.getId()-->Causes breakage*//*)*/,rate:p.bidRate,points:p.bidPrice,bidder:user,timestamp:t,accepted:accepted}],false);if(accepted){/*Send email*/}return;}
function receiveSell(p){Logger.log(JSON.stringify(p));var db=ScriptDb.getMyDb(),user=Session.getUser().getEmail(),i,r,rb,t=new Date().getTime();switch(p.k){
    case "346f7w5jalx8cdwsfc2d"/*Remove*/:p.db_id=LibraryjsUtil.rc4Decrypt("DktaE",p.  db_id           );r=db.load(p.db_id);r.remove  =p.remove  ;r.timestamp_remove  =t;break;
    case "8u0ghdqoe4bw7ypepi0e"/*Accept*/:p.db_id=LibraryjsUtil.rc4Decrypt("vDMm0",p./*db_id*/target_id);r=db.load(p.db_id);r.accepted=p.accepted;r.timestamp_accepted=t;
        i=r.bids.length;while(i--){if(r.bids[i].bidder==LibraryjsUtil.rc4Decrypt("WnJ9n",p.bidder)&&r.bids[i].rate==p.rate&&r.bids[i].points==p.points){r.bids[i].accepted=true;break;}}
        rb=db.query({target_id:p.db_id}).next();rb.accepted=true;rb.accepted_timestamp=t;break;
    default:break;}db.save(r);return;}
function receiveReport(p){Logger.log(JSON.stringify(p));var r,db=ScriptDb.getMyDb(),user=Session.getUser().getEmail(),t=new Date().getTime();p.db_id=LibraryjsUtil.rc4Decrypt("DktaE",p.db_id);r=db.load(p.db_id);r.roi.unshift({timestamp:t,amt:p.roi});db.save(r);return;}
function receiveScrape(p,source){ // Standardize scraped variables
 // var source=source||"fciEx",p=p||{"k":"36sgd2m257w2j0sn5isa","list":"{\"zip\":\"\",\"sa\":\"\",\"pctUpb\":85,\"ask\":237604.85,\"rateNote\":7.125,\"balCur\":279535.12,\"balBeg\":291600,\"lienPos\":1,\"loanStatus\":\"P\",\"foo\":\"width=\\\"154\\\" height=\\\"19\\\" class=\\\"tborder-left\\\" align=\\\"center\\\"\",\"sellerId\":\"U0001733\",\"link_sellerListings\":\"seller-listings.php?sellerID=1733\",\"state\":\"MI\",\"city\":\"West Bloomfield\",\"prodId\":13017,\"link_details\":\"/MICHIGAN/Residential/Performing/0013017.html\"}","detail":"{\"estPropVal_1\":\"0.00\",\"address\":\"West Bloomfield MI\",\"ask_1\":\"85\",\"foo\":\"id=\\\"c41_ctl\\\"\",\"productId\":\"0013017\",\"lienPos\":\"1\",\"loanStatus\":\"P\",\"paidTo\":\"12/01/2013\",\"loanMaturity\":\"09/01/2034\",\"loanType\":\"SFR\",\"ltvRatio\":\"0.000\",\"balBeg\":\"291600.00\",\"balCur\":\"279535.12\",\"estPropVal_2\":\"0.00\",\"valuationType\":\"Other\",\"valuationDate\":false,\"noteRate\":\"7.125\",\"soldRate\":\"0.000\",\"originationDate\":\"10/08/2003\",\"pmtFrequency\":\"Monthly\",\"pmtNextDue\":\"01/01/2014\",\"pmtMonthlyAmt\":\"2125.64\",\"taxesDue\":\"0.00\",\"loanCharges\":\"0.00\",\"lateChargeDays\":\"15\",\"unpaidInterest\":\"0.00\",\"lateCharge\":\"5.00\",\"ask_2\":\"85\",\"buyNow\":\".\",\"comments\":\"No comments.\",\"state\":\"MI\",\"city\":\"West,Bloomfield\"}"}
    ;p.list=JSON.parse(p.list);p.detail=JSON.parse(p.detail);//Logger.log(JSON.stringify(p));
    var ob=p 
      ; ob.accepted         = false
      ; ob.arv              = ""
      ; ob.askPrice         = (function(){try{ switch(source){case "fciEx":return ( p.list.ask                                            );break;case "noteMktPl":return ( p.detail.ask_2  ||  p.list.ask_1                );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error vWCQp: "+e.message);return ""}})()
      ; ob.askRate          = (function(){try{ switch(source){case "fciEx":return ( p.detail.soldRate||p.detail.noteRate||p.list.rateNote );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error L7R6M: "+e.message);return ""}})()
      ; ob.balBeg           = (function(){try{ switch(source){case "fciEx":return ( p.detail.balBeg        || p.list.balBeg               );break;case "noteMktPl":return ( p.detail.balBeg                                 );break;case "moolahList":return ( p.detail.amount           || p.list.amount                                            );break;default:return "";break;}}catch(e){Logger.log("Error Z4Ym4: "+e.message);return ""}})()
      ; ob.balCur           = (function(){try{ switch(source){case "fciEx":return ( p.detail.balCur        || p.list.balCur               );break;case "noteMktPl":return ( p.detail.balCur                                 );break;case "moolahList":return ( p.detail.amount           || p.list.amount                                            );break;default:return "";break;}}catch(e){Logger.log("Error wcQX5: "+e.message);return ""}})()
      ; ob.ballAmt          = ""
      ; ob.balloon          = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( p.detail.balloon                                );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error 4IxxQ: "+e.message);return ""}})()
      ; ob.baths            = ""
      ; ob.beds             = ""
      ; ob.borPts           = ""
      ; ob.borRate          = (function(){try{ switch(source){case "fciEx":return ( p.detail.noteRate      || p.list.rateNote             );break;case "noteMktPl":return ( p.detail.borRate                                );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error v2JrB: "+e.message);return ""}})()
      ; ob.city             = (function(){try{ switch(source){case "fciEx":return ( p.list.city            || p.detail.city               );break;case "noteMktPl":return ( p.detail.city                                   );break;case "moolahList":return ( p.detail.city                                                                         );break;default:return "";break;}}catch(e){Logger.log("Error yELY4: "+e.message);return ""}})()
      ; ob.dateMaturity_day = (function(){try{ switch(source){case "fciEx":return ( p.detail.loanMaturity   .day                          );break;case "noteMktPl":return ( p.detail.maturityDate   .day                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error jXEr5: "+e.message);return ""}})()
      ; ob.dateMaturity_mo  = (function(){try{ switch(source){case "fciEx":return ( p.detail.loanMaturity   .month                        );break;case "noteMktPl":return ( p.detail.maturityDate   .month                  );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error Umkgq: "+e.message);return ""}})()
      ; ob.dateMaturity_yr  = (function(){try{ switch(source){case "fciEx":return ( p.detail.loanMaturity   .year                         );break;case "noteMktPl":return ( p.detail.maturityDate   .year                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error a90Sq: "+e.message);return ""}})()
      ; ob.datePaidTo_day   = (function(){try{ switch(source){case "fciEx":return ( p.detail.paidTo         .day                          );break;case "noteMktPl":return ( p.detail.lastPmtDate    .day                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error ZzL60: "+e.message);return ""}})()
      ; ob.datePaidTo_mo    = (function(){try{ switch(source){case "fciEx":return ( p.detail.paidTo         .month                        );break;case "noteMktPl":return ( p.detail.lastPmtDate    .month                  );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error rXGRu: "+e.message);return ""}})()
      ; ob.datePaidTo_yr    = (function(){try{ switch(source){case "fciEx":return ( p.detail.paidTo         .year                         );break;case "noteMktPl":return ( p.detail.lastPmtDate    .year                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error 44Uav: "+e.message);return ""}})()
      ; ob.dateNext_day     = (function(){try{ switch(source){case "fciEx":return ( p.detail.pmtNextDue     .day                          );break;case "noteMktPl":return (""                                               );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error BXltz: "+e.message);return ""}})()
      ; ob.dateNext_mo      = (function(){try{ switch(source){case "fciEx":return ( p.detail.pmtNextDue     .month                        );break;case "noteMktPl":return (""                                               );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error lYU7Y: "+e.message);return ""}})()
      ; ob.dateNext_yr      = (function(){try{ switch(source){case "fciEx":return ( p.detail.pmtNextDue     .year                         );break;case "noteMktPl":return (""                                               );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error EwT1t: "+e.message);return ""}})()
      ; ob.dateOrig_day     = (function(){try{ switch(source){case "fciEx":return ( p.detail.originationDate.day                          );break;case "noteMktPl":return ( p.detail.originationDate.day                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error Oiauo: "+e.message);return ""}})()
      ; ob.dateOrig_mo      = (function(){try{ switch(source){case "fciEx":return ( p.detail.originationDate.month                        );break;case "noteMktPl":return ( p.detail.originationDate.month                  );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error pimlG: "+e.message);return ""}})()
      ; ob.dateOrig_yr      = (function(){try{ switch(source){case "fciEx":return ( p.detail.originationDate.year                         );break;case "noteMktPl":return ( p.detail.originationDate.year                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error l2FMa: "+e.message);return ""}})()
      ; ob.datePosted_day   = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.datePosted.day                                                               );break;default:return "";break;}}catch(e){Logger.log("Error lkReb: "+e.message);return ""}})()
      ; ob.datePosted_mo    = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.list  .datePosted.split("/")[0] /* Ex. p.list.datePosted.month=="8/9" */            );break;default:return "";break;}}catch(e){Logger.log("Error d2bQk: "+e.message);return ""}})()
      ; ob.datePosted_yr    = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.datePosted.year                                                              );break;default:return "";break;}}catch(e){Logger.log("Error HavAK: "+e.message);return ""}})()
      ; ob.doc_appraisal    = true
      ; ob.doc_closing      = true
      ; ob.doc_hazard       = true
      ; ob.doc_note         = true
      ; ob.doc_pics         = true
      ; ob.doc_pmts         = true
      ; ob.doc_title        = true
      ; ob.downPmt          = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.availDown                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error 9GcvY: "+e.message);return ""}})()
      ; ob.estDate_day      = (function(){try{ switch(source){case "fciEx":return ( p.detail.valuationDate  .day                          );break;case "noteMktPl":return ( p.detail.valuationDate  .day                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error nNDdI: "+e.message);return ""}})()
      ; ob.estDate_mo       = (function(){try{ switch(source){case "fciEx":return ( p.detail.valuationDate  .month                        );break;case "noteMktPl":return ( p.detail.valuationDate  .month                  );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error XwCFR: "+e.message);return ""}})()
      ; ob.estDate_yr       = (function(){try{ switch(source){case "fciEx":return ( p.detail.valuationDate  .year                         );break;case "noteMktPl":return ( p.detail.valuationDate  .year                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error CvZD6: "+e.message);return ""}})()
      ; ob.estMethod        = (function(){try{ switch(source){case "fciEx":return ( p.detail.valuationType                                );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error rHE5W: "+e.message);return ""}})()
      ; ob.estValue         = (function(){try{ switch(source){case "fciEx":return ( p.detail.estPropVal_2  || p.detail.estPropVal_1       );break;case "noteMktPl":return ( p.detail.propVal                                );break;case "moolahList":return ( p.detail.collateralValue                                                              );break;default:return "";break;}}catch(e){Logger.log("Error Pfrrq: "+e.message);return ""}})()
      ; ob.exit             = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.exitPlan                                                                     );break;default:return "";break;}}catch(e){Logger.log("Error lHcPk: "+e.message);return ""}})()
      ; ob.fileDoc          = ""
      ; ob.filePic          = ""
   // ; ob.item             = ""
      ; ob.lienPos          = (function(){try{ switch(source){case "fciEx":return ( p.detail.lienPos       || p.list.lienPos              );break;case "noteMktPl":return ( p.detail.lienPosition                           );break;case "moolahList":return ( p.detail.lienPos  || p.list.lienPos                                                   );break;default:return "";break;}}catch(e){Logger.log("Error LTAL9: "+e.message);return ""}})()
      ; ob.loanStatus       = (function(){try{ switch(source){case "fciEx":return ( p.detail.loanStatus    || p.list.loanStatus           );break;case "noteMktPl":return ( p.list.loanStatus                               );break;case "moolahList":return ( "A"                                                                                   );break;default:return "";break;}}catch(e){Logger.log("Error J2xVe: "+e.message);return ""}})()
      ; ob.notes            = (function(){try{ switch(source){case "fciEx":return ( p.list.comments                                       );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( "Exit:<br>" + p.detail.exitPlan + "<br><br>Funds used for:<br>" + p.detail.useOfFunds );break;default:return "";break;}}catch(e){Logger.log("Error 1S2yI: "+e.message);return ""}})()
      ; ob.occ              = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( p.detail.ownerOccupied                          );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error pyVar: "+e.message);return ""}})()
      ; ob.payBad           = ""
      ; ob.payGood          = ""
      ; ob.pctLtv           = (function(){try{ switch(source){case "fciEx":return ( p.detail.ltvRatio                                     );break;case "noteMktPl":return ( Math.round(100*p.detail.balCur/p.detail.propVal));break;case "moolahList":return ( p.detail.ltv      || p.list.ltv                                                       );break;default:return "";break;}}catch(e){Logger.log("Error o9kiy: "+e.message);return ""}})()
      ; ob.pctUpb           = (function(){try{ switch(source){case "fciEx":return ((p.detail.ask_2 || p.detail.ask_1) || p.list.pctUpb    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error MMJJM: "+e.message);return ""}})()
      ; ob.pmtAmt           = (function(){try{ switch(source){case "fciEx":return ( p.detail.pmtMonthlyAmt                                );break;case "noteMktPl":return ( p.detail.pmtNote                                );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error G6HvR: "+e.message);return ""}})()
   // ; ob.pmtsLeft         = ""
   // ; ob.pmtsRecd         = ""
      ; ob.purpose          = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.loanType || p.list.loanType                                                  );break;default:return "";break;}}catch(e){Logger.log("Error h6gpy: "+e.message);return ""}})()
      ; ob.purPrice         = ""
      ; ob.remove           = false
      ; ob.rent             = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( p.detail.rent                                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error 7X5F7: "+e.message);return ""}})()
      ; ob.sa               = (function(){try{ switch(source){case "fciEx":return ( p.list.sa                                             );break;case "noteMktPl":return ( ""                                              );break;case "moolahList":return ( p.detail.sa                                                                           );break;default:return "";break;}}catch(e){Logger.log("Error bbF5g: "+e.message);return ""}})()
      ; ob.schedRE          = ""
      ; ob.seller           = (function(){try{ switch(source){case "fciEx":return ( "fciEx_"+p.list.prodId || "fciEx_"+p.detail.productId );break;case "noteMktPl":return ( p.detail.link_details_2||p.list.link_details_1  );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error QqeYq: "+e.message);return ""}})()
      ; ob.source           = (function(){try{ switch(source){case "fciEx":return ( "fciEx_"+p.list.sellerId                              );break;case "noteMktPl":return ( "noteMktPl_"+p.list.sellerId                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error wZjUY: "+e.message);return ""}})()
      ; ob.sqft             = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( p.detail.sqft                                   );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error 3rgiy: "+e.message);return ""}})()
      ; ob.sqftLot          = (function(){try{ switch(source){case "fciEx":return ( ""                                                    );break;case "noteMktPl":return ( p.detail.sqftLot                                );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error uDr7j: "+e.message);return ""}})()
      ; ob.state            = (function(){try{ switch(source){case "fciEx":return ( p.detail.state         || p.list.state                );break;case "noteMktPl":return ( p.detail.state                                  );break;case "moolahList":return ( p.detail.state    || p.list.state                                                     );break;default:return "";break;}}catch(e){Logger.log("Error lBDV3: "+e.message);return ""}})()
      ; ob.table            = "note"
   // ; ob.term             = ""
      ; ob.timestamp_posted = new Date().getTime()
      ; ob.use              = (function(){try{ switch(source){case "fciEx":return ( p.detail.loanType                                     );break;case "noteMktPl":return ( p.detail.propertyType                           );break;case "moolahList":return ( p.detail.propertyType || p.list.propertyType                                          );break;default:return "";break;}}catch(e){Logger.log("Error 64IzN: "+e.message);return ""}})()
      ; ob.zip              = (function(){try{ switch(source){case "fciEx":return ( p.list.zip                                            );break;case "noteMktPl":return ( p.detail.zip                                    );break;case "moolahList":return ( ""                                                                                    );break;default:return "";break;}}catch(e){Logger.log("Error Z6a5P: "+e.message);return ""}})()
   // Calculations follow
      ; ob.pctLtvCur        = (function(){try{ return  Math.round(ob.pctLtv *ob.askPrice/ob.balCur) || Math.round(100*ob.askPrice/ob.estValue)}catch(e){Logger.log("Error ymo6h: "+e.message);return ""}})()
      ; ob.pctUpb           = (function(){try{ return                                    ob.pctUpb  || Math.round(100*ob.askPrice/ob.balCur  )}catch(e){Logger.log("Error bon5V: "+e.message);return ""}})()
      ; ob.yieldCur         = (function(){try{ return (Math.round(1000*ob.borRate*ob.balCur/ob.askPrice)) / 1000                              }catch(e){Logger.log("Error K4R0D: "+e.message);return ""}})()
   // ; ob.ytm              = (function(){try{               Complex calculation goes here                                                    }catch(e){Logger.log("Error nx4TR: "+e.message);return ""}})()
	  ;/*Logger.log(JSON.stringify(ob));*/var db=ScriptDb.getMyDb(),id=db.save(ob).getId(),r=db.load(id);r.item=LibraryjsUtil.toBase62(Number(id.slice(1)));db.save(r);/*Logger.log(JSON.stringify(r));*/return;}
// --------------------------- Serve Outside GAS ---------------------------
function serveSellers(){var ob=[],arr=[],i,j,k,r,t=[],zil=[],user=Session.getUser().getEmail(),out={"totalResultsCount":0,"records":[]},db=ScriptDb.getMyDb(),q={table:"note",remove:false};if(user!="atlaslive@gmail.com"){q.seller=user}var results=db.query(q);while(results.hasNext()){r=results.next();i=out.totalResultsCount++;
    try{out.records[i]={db_id:LibraryjsUtil.rc4Encrypt("DktaE",r.getId())}}catch(e){Logger.log("Error BDhqq: "+e.message)}try{var currentBids=LibraryjsUtil.getCurrentBids(r.bids)||[],m=0;}catch(e){Logger.log("Error Fr10a: "+e.message)}try{m=currentBids.length}catch(e){Logger.log("Error lum87: "+e.message)}while(m--){currentBids[m].bidder=LibraryjsUtil.rc4Encrypt("WnJ9n",currentBids[m].bidder);currentBids[m].target_id=LibraryjsUtil.rc4Encrypt("vDMm0",currentBids[m].target_id);}var currentBidsLength=(currentBids)?currentBids.length:0;
	ob[i] = {
		"nolink"                         : {
                "accepted"               : function(){try{return                 r.accepted                                              }catch(e){Logger.log("Error BJrJb: "+e.message);return "";}}() //
            ,   "arv"                    : function(){try{return                 r.arv                                                   }catch(e){Logger.log("Error qEpyI: "+e.message);return "";}}() //
            ,   "askRate"                : function(){try{return                 r.askRate                                               }catch(e){Logger.log("Error XY3SN: "+e.message);return "";}}() //
            ,   "askPrice"               : function(){try{return                 r.askPrice                                              }catch(e){Logger.log("Error BbYOH: "+e.message);return "";}}() //
            ,   "baths"                  : function(){try{return                 r.baths                                                 }catch(e){Logger.log("Error iyWpu: "+e.message);return "";}}() //
            ,   "bidCount"               :                                         currentBidsLength
            ,   "bids"                   :                                         currentBids
            ,   "beds"                   : function(){try{return                 r.beds                                                  }catch(e){Logger.log("Error LuskC: "+e.message);return "";}}() //
            ,   "borRate"                : function(){try{return                 r.borRate                                               }catch(e){Logger.log("Error JLSLy: "+e.message);return "";}}() //
            ,   "borPts"                 : function(){try{return                 r.borPts                                                }catch(e){Logger.log("Error A8eEm: "+e.message);return "";}}() //
            ,   "city"                   : function(){try{return                 r.city                                                  }catch(e){Logger.log("Error xLGcf: "+e.message);return "";}}() //
            ,   "estMethod"              : function(){try{return                 r.estMethod                                             }catch(e){Logger.log("Error pVPll: "+e.message);return "";}}() //
            ,   "estValue"               : function(){try{return                 r.estValue                                              }catch(e){Logger.log("Error Dmg6z: "+e.message);return "";}}() //
            ,   "exit"                   : function(){try{return                 r.exit                                                  }catch(e){Logger.log("Error DjKI9: "+e.message);return "";}}() //
            ,   "fileDoc"                : function(){try{return                 r.fileDoc                                               }catch(e){Logger.log("Error nezPL: "+e.message);return "";}}() //
            ,   "filePic"                : function(){try{return                 r.filePic                                               }catch(e){Logger.log("Error B3b29: "+e.message);return "";}}() //
            ,   "item"                   : function(){try{return                 r.item                                                  }catch(e){Logger.log("Error 5hpm9: "+e.message);return "";}}() //
            ,   "notes"                  : function(){try{return                 r.notes                                                 }catch(e){Logger.log("Error 2x3QK: "+e.message);return "";}}() //
            ,   "payBad"                 : function(){try{return                 r.payBad                                                }catch(e){Logger.log("Error Vjx8Z: "+e.message);return "";}}() //
            ,   "payGood"                : function(){try{return                 r.payGood                                               }catch(e){Logger.log("Error HoQPl: "+e.message);return "";}}() //
            ,   "pctLtv"                 : function(){try{return                 r.pctLtv                                                }catch(e){Logger.log("Error VfbpT: "+e.message);return "";}}() //
            ,   "purpose"                : function(){try{return                 r.purpose                                               }catch(e){Logger.log("Error kmACu: "+e.message);return "";}}() //
            ,   "purPrice"               : function(){try{return                 r.purPrice                                              }catch(e){Logger.log("Error tXdxn: "+e.message);return "";}}() //
			,   "remove"                 : function(){try{return                 r.remove                                                }catch(e){Logger.log("Error wGy6P: "+e.message);return "";}}() //					   
            ,   "rent"                   : function(){try{return                 r.rent                                                  }catch(e){Logger.log("Error 8pAi5: "+e.message);return "";}}() //
            ,   "sa"                     : function(){try{return                 r.sa                                                    }catch(e){Logger.log("Error unh8c: "+e.message);return "";}}() //
            ,   "schedRE"                : function(){try{return                 r.schedRE                                               }catch(e){Logger.log("Error 8cItd: "+e.message);return "";}}() //
         // ,   "sellCarry"              : function(){try{return                 r.sellCarry                                             }catch(e){Logger.log("Error 2jqDq: "+e.message);return "";}}() //
            ,   "sqft"                   : function(){try{return                 r.sqft                                                  }catch(e){Logger.log("Error NbtEx: "+e.message);return "";}}() //
            ,   "sqftLot"                : function(){try{return                 r.sqftLot                                               }catch(e){Logger.log("Error XILuW: "+e.message);return "";}}() //
            ,   "state"                  : function(){try{return                 r.state                                                 }catch(e){Logger.log("Error bp1Y9: "+e.message);return "";}}() //
            ,   "term"                   : function(){try{return                 r.term                                                  }catch(e){Logger.log("Error lLMzH: "+e.message);return "";}}() //
            ,   "use"                    : function(){try{return                 r.use                                                   }catch(e){Logger.log("Error QC8lk: "+e.message);return "";}}() //
            ,   "zip"                    : function(){try{return                 r.zip                                                   }catch(e){Logger.log("Error kPZtm: "+e.message);return "";}}() //
                                         // Below added from "comprehensive" form
            ,   "balBeg"                 : function(){try{return                 r.balBeg                                                }catch(e){Logger.log("Error hUgqK: "+e.message);return "";}}() //
            ,   "balCur"                 : function(){try{return                 r.balCur                                                }catch(e){Logger.log("Error T20mK: "+e.message);return "";}}() //
            ,   "balloon"                : function(){try{return                 r.balloon                                               }catch(e){Logger.log("Error Gu3BG: "+e.message);return "";}}() //
            ,   "ballAmt"                : function(){try{return                 r.ballAmt                                               }catch(e){Logger.log("Error EtGlv: "+e.message);return "";}}() //
            ,   "dateMaturity_day"       : function(){try{return                 r.dateMaturity_day                                      }catch(e){Logger.log("Error k8sgQ: "+e.message);return "";}}() //
            ,   "dateMaturity_mo"        : function(){try{return                 r.dateMaturity_mo                                       }catch(e){Logger.log("Error ZvK5p: "+e.message);return "";}}() //
            ,   "dateMaturity_yr"        : function(){try{return                 r.dateMaturity_yr                                       }catch(e){Logger.log("Error 78IS5: "+e.message);return "";}}() //
            ,   "dateOrig_day"           : function(){try{return                 r.dateOrig_day                                          }catch(e){Logger.log("Error wgi3D: "+e.message);return "";}}() //
            ,   "dateOrig_mo"            : function(){try{return                 r.dateOrig_mo                                           }catch(e){Logger.log("Error umJ5V: "+e.message);return "";}}() //
            ,   "dateOrig_yr"            : function(){try{return                 r.dateOrig_yr                                           }catch(e){Logger.log("Error 4SzNU: "+e.message);return "";}}() //
            ,   "datePaidTo_day"         : function(){try{return                 r.datePaidTo_day                                        }catch(e){Logger.log("Error 3t6gE: "+e.message);return "";}}() //
            ,   "datePaidTo_mo"          : function(){try{return                 r.datePaidTo_mo                                         }catch(e){Logger.log("Error oI3d7: "+e.message);return "";}}() //
            ,   "datePaidTo_yr"          : function(){try{return                 r.datePaidTo_yr                                         }catch(e){Logger.log("Error aW7iI: "+e.message);return "";}}() //
            ,   "doc_appraisal"          : function(){try{return                 r.doc_appraisal                                         }catch(e){Logger.log("Error lM8Rh: "+e.message);return "";}}() //
            ,   "doc_closing"            : function(){try{return                 r.doc_closing                                           }catch(e){Logger.log("Error RPjQ4: "+e.message);return "";}}() //
            ,   "doc_hazard"             : function(){try{return                 r.doc_hazard                                            }catch(e){Logger.log("Error beDcp: "+e.message);return "";}}() //
            ,   "doc_note"               : function(){try{return                 r.doc_note                                              }catch(e){Logger.log("Error OdOtT: "+e.message);return "";}}() //
            ,   "doc_pics"               : function(){try{return                 r.doc_pics                                              }catch(e){Logger.log("Error kcR84: "+e.message);return "";}}() //
            ,   "doc_pmts"               : function(){try{return                 r.doc_pmts                                              }catch(e){Logger.log("Error UtVlc: "+e.message);return "";}}() //
            ,   "doc_title"              : function(){try{return                 r.doc_title                                             }catch(e){Logger.log("Error XqmY9: "+e.message);return "";}}() //
            ,   "downPmt"                : function(){try{return                 r.downPmt                                               }catch(e){Logger.log("Error dbdi6: "+e.message);return "";}}() //
            ,   "lienPos"                : function(){try{return                 r.lienPos                                               }catch(e){Logger.log("Error ZeQtV: "+e.message);return "";}}() //
            ,   "loanStatus"             : function(){try{return                 r.loanStatus                                            }catch(e){Logger.log("Error R4vCp: "+e.message);return "";}}() //
            ,   "nextDue_day"            : function(){try{return                 r.nextDue_day                                           }catch(e){Logger.log("Error VlULN: "+e.message);return "";}}() //
            ,   "nextDue_mo"             : function(){try{return                 r.nextDue_mo                                            }catch(e){Logger.log("Error u5t9E: "+e.message);return "";}}() //
            ,   "nextDue_yr"             : function(){try{return                 r.nextDue_yr                                            }catch(e){Logger.log("Error v0AQd: "+e.message);return "";}}() //
            ,   "occ"                    : function(){try{return                 r.occ                                                   }catch(e){Logger.log("Error VXTKH: "+e.message);return "";}}() //
            ,   "pmtAmt"                 : function(){try{return                 r.pmtAmt                                                }catch(e){Logger.log("Error DVOz2: "+e.message);return "";}}() //
            ,   "pmtsLeft"               : function(){try{return                 r.pmtsLeft                                              }catch(e){Logger.log("Error jxMGp: "+e.message);return "";}}() //
            ,   "pmtsRecd"               : function(){try{return                 r.pmtsRecd                                              }catch(e){Logger.log("Error 6iRdj: "+e.message);return "";}}() //
                                           }
     /* ,   "link"                       : {
			,	"link_boa"               : function(){try{return  /*ok* /        r.link.boa                                              }catch(e){Logger.log("Error SCgK1: "+e.message);return "";}}() //
			,	"link_chase"             : function(){try{return  /*ok* /        r.link.chase                                            }catch(e){Logger.log("Error MqQEZ: "+e.message);return "";}}() //
            ,	"link_eppraisal"         : function(){try{return  /*L1* /        r.avm.dataset.eppraisal.link                            }catch(e){Logger.log("Error u7F2J: "+e.message);return "";}}() // Errors: L1 local; L2 site suspected; L3 site confirmed; OK works; ok works but must copy/paste address
				"link_googleMap"         : function(){try{return  /*OK* /        r.link.gmap                                             }catch(e){Logger.log("Error XqSd4: "+e.message);return "";}}() //
			,	"link_homeGain"          : function(){try{return  /*L3* /        r.avm.dataset.homeGain.link                             }catch(e){Logger.log("Error XqSd4: "+e.message);return "";}}() //
			,	"link_homesCom"          : function(){try{return  /*ok* /        r.link.homesCom                                         }catch(e){Logger.log("Error KmlFz: "+e.message);return "";}}() //
			,	"link_neighborhoodScout" : function(){try{return  /*ok* /        r.link.neighborhoodScout                                }catch(e){Logger.log("Error A9rGd: "+e.message);return "";}}() //
			,	"link_propertyShark"     : function(){try{return  /*ok* /        r.link.propertyShark                                    }catch(e){Logger.log("Error tAFdc: "+e.message);return "";}}() //
			,	"link_realEstate"        : function(){try{return  /*OK* /        r.avm.dataset.realEstate.link                           }catch(e){Logger.log("Error kxgjs: "+e.message);return "";}}() //
			,	"link_realtor"           : function(){try{return  /*OK* /        r.avm.dataset.realtor.link                              }catch(e){Logger.log("Error guA6g: "+e.message);return "";}}() //
			,	"link_trulia"            : function(){try{return  /*OK* /        r.avm.dataset.trulia.link                               }catch(e){Logger.log("Error dpR2i: "+e.message);return "";}}() //
			,	"link_yahoo"             : function(){try{return  /*OK* /        r.link.yahoo	   				                         }catch(e){Logger.log("Error 5nBQT: "+e.message);return "";}}() //
			,	"link_zillow"            : function(){try{return  /*OK* /        r.link.zillow                                           }catch(e){Logger.log("Error eqDM0: "+e.message);return "";}}() //
			,	"link_zillowdetails"     : function(){try{return  /*OK* /        zil[i].links.homedetails.Text                           }catch(e){Logger.log("Error boXfk: "+e.message);return "";}}() //
			,	"link_zipRealty"         : function(){try{return                 ""                                                      }catch(e){Logger.log("Error 9IGmd: "+e.message);return "";}}() //            
			,	"link_zipSkinny"         : function(){try{return  /*ok* /        r.link.zipSkinny                                        }catch(e){Logger.log("Error CsFnp: "+e.message);return "";}}() //
										   } */
	} // db_id MyBid // arv rep cof com city state zip sa useCode beds baths sf sf_round lot lot_round yearBuilt taxVal taxVal_round lastSoldPrice lastSoldPrice_round lastSoldYear taxAmt taxAmt_round ask ask_round autoEst autoEst_round sdPct popCount rent rent_round ratio grm ia ia_round psf avmStatSet // link_googleMap link_yahoo link_zillow link_zillowdetails link_eppraisal link_realtor link_realEstate link_homeGain link_trulia link_propertyShark link_neighborhoodScout link_zipSkinny link_chase link_boa link_homesCom
	var keys=Object.keys(ob[i].nolink),z=keys.length;while(z--){out.records[i][keys[z]]=              ob[i].nolink[keys[z]]                                   }
     // keys=Object.keys(ob[i].  link),z=keys.length;while(z--){out.records[i][keys[z]]='<a href="' + ob[i].  link[keys[z]] + '" target="_blank">&#10151;</a>'}Logger.log(JSON.stringify(out.records[i]));
	}return out;}
function serveBuyers(){var ob=[],arr=[],i,j,k,r,t=[],zil=[],bidRate="",bidPrice="",bidTime=0,user=Session.getUser().getEmail(),out={"totalResultsCount":0,"records":[]},db=ScriptDb.getMyDb(),results=db.query({table:"note",remove:false,accepted:false});while(results.hasNext()){r=results.next();i=out.totalResultsCount++;bidRate="";bidPrice="";bidTime=0;
	try{out.records[i]={db_id:LibraryjsUtil.rc4Encrypt("DktaE",r.getId())};}catch(e){Logger.log("Error WZ6bM: "+e.message)};try{j=r.bids.length;while(j--){if(r.bids[j].bidder==user&&(r.bids[j].timestamp>bidTime)){bidRate=r.bids[j].rate;bidPrice=r.bids[j].points;bidTime=r.bids[j].timestamp;break;}}}catch(e){Logger.log("Error rRblA: "+e.message);} // try{if(r.bids){arr[i]=r.bids;j=arr[i].length;while(j--){t[j]=0;if(arr[i][j].bidder==user&&(arr[i][j].time>t[j])/*&&(!arr[i][j].confirmed)*/){t[j]=arr[i][j].time;out.records[i].MyBid=arr[i][j].balCur}}             }}catch(e){Logger.log("Error soF2q: "+e.message)}; // "MyBid"
	ob[i] = { //vol={SFR:1246,Other:298,CRE:269,X:101,MUL:52,Land:32,Date:new Date().setFullYear(2014,1,1),Sources:["fciEx","NoteMktPl","moolahList"]}
		"nolink"                         : {
                "amount"                 : function(){try{return                 r.balCur                                                }catch(e){Logger.log("Error 5HyYI: "+e.message);return "";}}() //
            ,   "arv"                    : function(){try{return                 r.arv                                                   }catch(e){Logger.log("Error 0kR70: "+e.message);return "";}}() //
            ,   "askPrice"               : function(){try{return                 r.askPrice                                              }catch(e){Logger.log("Error yRAyQ: "+e.message);return "";}}() //
            ,   "askRate"                : function(){try{return                 r.askRate                                               }catch(e){Logger.log("Error 742Ho: "+e.message);return "";}}() //
            ,   "baths"                  : function(){try{return                 r.baths                                                 }catch(e){Logger.log("Error 4zKoo: "+e.message);return "";}}() //
            ,   "beds"                   : function(){try{return                 r.beds                                                  }catch(e){Logger.log("Error qAPG7: "+e.message);return "";}}() //
            ,   "bidPrice"               :                                         bidPrice
            ,   "bidRate"                :                                         bidRate
            ,   "bidTime"                :                                         bidTime
            ,   "borPts"                 : function(){try{return                 r.borPts                                                }catch(e){Logger.log("Error uuT8p: "+e.message);return "";}}() //
            ,   "borRate"                : function(){try{return                 r.borRate                                               }catch(e){Logger.log("Error 0dkMZ: "+e.message);return "";}}() //
            ,   "city"                   : function(){try{return                 r.city                                                  }catch(e){Logger.log("Error SUbA2: "+e.message);return "";}}() //
            ,   "estValue"               : function(){try{return                 r.estValue                                              }catch(e){Logger.log("Error vvsvJ: "+e.message);return "";}}() //
            ,   "estMethod"              : function(){try{return                 r.estMethod                                             }catch(e){Logger.log("Error 5aTX1: "+e.message);return "";}}() //
            ,   "exit"                   : function(){try{return                 r.exit                                                  }catch(e){Logger.log("Error vuQlW: "+e.message);return "";}}() //
            ,   "filePic"                : function(){try{return                 r.filePic                                               }catch(e){Logger.log("Error 3aGMP: "+e.message);return "";}}() //
            ,   "fileDoc"                : function(){try{return                 r.fileDoc                                               }catch(e){Logger.log("Error KelFd: "+e.message);return "";}}() //
            ,   "item"                   : function(){try{return                 r.item                                                  }catch(e){Logger.log("Error WWwZS: "+e.message);return "";}}() //
            ,   "notes"                  : function(){try{return                 r.notes                                                 }catch(e){Logger.log("Error LJ2Ji: "+e.message);return "";}}() //
            ,   "payBad"                 : function(){try{return                 r.payBad                                                }catch(e){Logger.log("Error 2KNwa: "+e.message);return "";}}() //
            ,   "payGood"                : function(){try{return                 r.payGood                                               }catch(e){Logger.log("Error mAIv8: "+e.message);return "";}}() //
            ,   "purPrice"               : function(){try{return                 r.purPrice                                              }catch(e){Logger.log("Error y28d6: "+e.message);return "";}}() //
            ,   "pctLtv"                 : function(){try{return                 r.pctLtv                                                }catch(e){Logger.log("Error aCV5h: "+e.message);return "";}}() //
            ,   "pctLtvCur"              : function(){try{return                 r.pctLtvCur                                             }catch(e){Logger.log("Error DIzg5: "+e.message);return "";}}() //
            ,   "pctUpb"                 : function(){try{return                 r.pctUpb                                                }catch(e){Logger.log("Error v9ABL: "+e.message);return "";}}() //
            ,   "rent"                   : function(){try{return                 r.rent                                                  }catch(e){Logger.log("Error 3Q3mf: "+e.message);return "";}}() //
            ,   "sa"                     : function(){try{return                 r.sa                                                    }catch(e){Logger.log("Error yJ4Ld: "+e.message);return "";}}() //
            ,   "schedRE"                : function(){try{return                 r.schedRE                                               }catch(e){Logger.log("Error ZmwlY: "+e.message);return "";}}() //
         // ,   "sellCarry"              : function(){try{return                 r.sellCarry                                             }catch(e){Logger.log("Error HPfzp: "+e.message);return "";}}() //
            ,   "state"                  : function(){try{return                 r.state                                                 }catch(e){Logger.log("Error ljckt: "+e.message);return "";}}() //
            ,   "term"                   : function(){try{return                 r.term                                                  }catch(e){Logger.log("Error qVFj6: "+e.message);return "";}}() //
            ,   "use"                    : function(){try{return                 r.use                                                   }catch(e){Logger.log("Error lvWPA: "+e.message);return "";}}() //
            ,   "sqft"                   : function(){try{return                 r.sqft                                                  }catch(e){Logger.log("Error PLhJh: "+e.message);return "";}}() //
            ,   "sqftLot"                : function(){try{return                 r.sqftLot                                               }catch(e){Logger.log("Error B1JSW: "+e.message);return "";}}() //
            ,   "yieldCur"               : function(){try{return                 r.yieldCur                                              }catch(e){Logger.log("Error wWXwH: "+e.message);return "";}}() //
        //  ,   "ytm"                    : function(){try{return                 r.ytm                                                   }catch(e){Logger.log("Error USixk: "+e.message);return "";}}() //
            ,   "zip"                    : function(){try{return                 r.zip                                                   }catch(e){Logger.log("Error C3Agp: "+e.message);return "";}}() //
        //  Below added from "comprehensive" form
            ,   "purpose"                : function(){try{return                 r.purpose                                               }catch(e){Logger.log("Error vUVKq: "+e.message);return "";}}() //
            ,   "balBeg"                 : function(){try{return                 r.balBeg                                                }catch(e){Logger.log("Error 8Z3u2: "+e.message);return "";}}() //
            ,   "balCur"                 : function(){try{return                 r.balCur                                                }catch(e){Logger.log("Error yikFu: "+e.message);return "";}}() //
            ,   "ballAmt"                : function(){try{return                 r.ballAmt                                               }catch(e){Logger.log("Error IWozK: "+e.message);return "";}}() //
            ,   "balloon"                : function(){try{return                 r.balloon                                               }catch(e){Logger.log("Error CnjWT: "+e.message);return "";}}() //
            ,   "dateOrig_mo"            : function(){try{return                 r.dateOrig_mo                                           }catch(e){Logger.log("Error ibLvh: "+e.message);return "";}}() //
            ,   "dateOrig_day"           : function(){try{return                 r.dateOrig_day                                          }catch(e){Logger.log("Error hQyCX: "+e.message);return "";}}() //
            ,   "dateOrig_yr"            : function(){try{return                 r.dateOrig_yr                                           }catch(e){Logger.log("Error WQ0OE: "+e.message);return "";}}() //
            ,   "datePaidTo"             : function(){try{return                 r.datePaidTo                                            }catch(e){Logger.log("Error Uj7Op: "+e.message);return "";}}() //
            ,   "dateMaturity"           : function(){try{return                 r.dateMaturity                                          }catch(e){Logger.log("Error RWkOW: "+e.message);return "";}}() //
            ,   "doc_appraisal"          : function(){try{return                 r.doc_appraisal                                         }catch(e){Logger.log("Error yU2J6: "+e.message);return "";}}() //
            ,   "doc_closing"            : function(){try{return                 r.doc_closing                                           }catch(e){Logger.log("Error tW7O4: "+e.message);return "";}}() //
            ,   "doc_hazard"             : function(){try{return                 r.doc_hazard                                            }catch(e){Logger.log("Error dVVZI: "+e.message);return "";}}() //
            ,   "doc_note"               : function(){try{return                 r.doc_note                                              }catch(e){Logger.log("Error TD1WW: "+e.message);return "";}}() //
            ,   "doc_pics"               : function(){try{return                 r.doc_pics                                              }catch(e){Logger.log("Error z5Qc2: "+e.message);return "";}}() //
            ,   "doc_pmts"               : function(){try{return                 r.doc_pmts                                              }catch(e){Logger.log("Error dvy7J: "+e.message);return "";}}() //
            ,   "doc_title"              : function(){try{return                 r.doc_title                                             }catch(e){Logger.log("Error EGC0J: "+e.message);return "";}}() //
            ,   "downPmt"                : function(){try{return                 r.downPmt                                               }catch(e){Logger.log("Error O2cuy: "+e.message);return "";}}() //
            ,   "lienPos"                : function(){try{return                 r.lienPos                                               }catch(e){Logger.log("Error O3FV4: "+e.message);return "";}}() //
            ,   "loanStatus"             : function(){try{return                 r.loanStatus                                            }catch(e){Logger.log("Error dNB1K: "+e.message);return "";}}() //
            ,   "nextDue"                : function(){try{return                 r.nextDue                                               }catch(e){Logger.log("Error 3mqXN: "+e.message);return "";}}() //
            ,   "occ"                    : function(){try{return                 r.occ                                                   }catch(e){Logger.log("Error Wv53u: "+e.message);return "";}}() //
            ,   "pmtAmt"                 : function(){try{return                 r.pmtAmt                                                }catch(e){Logger.log("Error ja3Oe: "+e.message);return "";}}() //
            ,   "pmtsLeft"               : function(){try{return                 r.pmtsLeft                                              }catch(e){Logger.log("Error YrLFV: "+e.message);return "";}}() //
            ,   "pmtsRecd"               : function(){try{return                 r.pmtsRecd                                              }catch(e){Logger.log("Error PtIqd: "+e.message);return "";}}() //
										   }
     /* ,   "link"                       : {
				"link_boa"               : function(){try{return  /*ok* /        r.link.boa                                              }catch(e){Logger.log("Error Zd0Y2: "+e.message);return "";}}() //
			,	"link_chase"             : function(){try{return  /*ok* /        r.link.chase                                            }catch(e){Logger.log("Error WMju3: "+e.message);return "";}}() //
            ,	"link_eppraisal"         : function(){try{return  /*L1* /        r.avm.dataset.eppraisal.link                            }catch(e){Logger.log("Error lrEOS: "+e.message);return "";}}() // Errors: L1 local; L2 site suspected; L3 site confirmed; OK works; ok works but must copy/paste address
			,	"link_googleMap"         : function(){try{return  /*OK* /        r.link.gmap                                             }catch(e){Logger.log("Error gtC5Q: "+e.message);return "";}}() //
			,	"link_homeGain"          : function(){try{return  /*L3* /        r.avm.dataset.homeGain.link                             }catch(e){Logger.log("Error paj87: "+e.message);return "";}}() //
			,	"link_homesCom"          : function(){try{return  /*ok* /        r.link.homesCom                                         }catch(e){Logger.log("Error oabbc: "+e.message);return "";}}() //
			,	"link_neighborhoodScout" : function(){try{return  /*ok* /        r.link.neighborhoodScout                                }catch(e){Logger.log("Error Q14RH: "+e.message);return "";}}() //
			,	"link_propertyShark"     : function(){try{return  /*ok* /        r.link.propertyShark                                    }catch(e){Logger.log("Error YRZsy: "+e.message);return "";}}() //
			,	"link_realEstate"        : function(){try{return  /*OK* /        r.avm.dataset.realEstate.link                           }catch(e){Logger.log("Error 0olDz: "+e.message);return "";}}() //
			,	"link_realtor"           : function(){try{return  /*OK* /        r.avm.dataset.realtor.link                              }catch(e){Logger.log("Error mtD5d: "+e.message);return "";}}() //
			,	"link_trulia"            : function(){try{return  /*OK* /        r.avm.dataset.trulia.link                               }catch(e){Logger.log("Error WKlaS: "+e.message);return "";}}() //
			,	"link_yahoo"             : function(){try{return  /*OK* /        r.link.yahoo	   				                         }catch(e){Logger.log("Error 1m0uk: "+e.message);return "";}}() //
			,	"link_zillow"            : function(){try{return  /*OK* /        r.link.zillow                                           }catch(e){Logger.log("Error vL9KJ: "+e.message);return "";}}() //
			,	"link_zillowdetails"     : function(){try{return  /*OK* /        zil[i].links.homedetails.Text                           }catch(e){Logger.log("Error 6Jafy: "+e.message);return "";}}() //
			,	"link_zipRealty"         : function(){try{return                 ""                                                      }catch(e){Logger.log("Error dvNJt: "+e.message);return "";}}() //            
			,	"link_zipSkinny"         : function(){try{return  /*ok* /        r.link.zipSkinny                                        }catch(e){Logger.log("Error d4sTP: "+e.message);return "";}}() //
										   } */
            } // db_id MyBid // arv rep cof com city state zip sa useCode beds baths sf sf_round lot lot_round yearBuilt taxVal taxVal_round lastSoldPrice lastSoldPrice_round lastSoldYear taxAmt taxAmt_round ask ask_round autoEst autoEst_round sdPct popCount rent rent_round ratio grm ia ia_round psf avmStatSet // link_googleMap link_yahoo link_zillow link_zillowdetails link_eppraisal link_realtor link_realEstate link_homeGain link_trulia link_propertyShark link_neighborhoodScout link_zipSkinny link_chase link_boa link_homesCom
	var keys=Object.keys(ob[i].nolink),z=keys.length;while(z--){out.records[i][keys[z]]=              ob[i].nolink[keys[z]]                                   }
     // keys=Object.keys(ob[i].  link),z=keys.length;while(z--){out.records[i][keys[z]]='<a href="' + ob[i].  link[keys[z]] + '" target="_blank">&#10151;</a>'}Logger.log(JSON.stringify(out.records[i]));
	}return out}
function dataTableConstructor(){//var LOAD=["https://sites.google.com/site/itr5k9zw23yzmxuaf5nb399c0ywb98/home/jsLoad.js","googleScripts"];eval(UrlFetchApp.fetch(LOAD[0]).getContentText());var files=load(LOAD[1]);var i=files.length;while(i---1){eval(UrlFetchApp.fetch(files[i]).getContentText())};
    var db=ScriptDb.getMyDb(),d=new Date().getTime(),user=Session.getUser().getEmail(),dt={},i=1,notelink,link,own,r,result;if(user=="atlaslive@gmail.com"||user=="benharvill@gmail.com"){result=db.query({table:"leads"})}else{result=db.query({table:"leads",owner:user/*"jrcamf@gmail.com"*/})}
    dt.cols=[{id:"ID"         ,label:"ID"         ,type:"number"}
            ,{id:"Link"       ,label:"Link"       ,type:"string"}
            ,{id:"Own"        ,label:"Own"        ,type:"string"}
         // ,{id:"Region"     ,label:"Region"     ,type:"string"}
            ,{id:"Pre"        ,label:"Pre"        ,type:"number"}
            ,{id:"E"          ,label:"E"          ,type:"number"}
            ,{id:"Nex"        ,label:"Nex"        ,type:"number"}
            ,{id:"T"          ,label:"T"          ,type:"string"}
            ,{id:"Disposition",label:"Disposition",type:"string"}
            ,{id:"Company"    ,label:"Company"    ,type:"string"}
            ,{id:"Phone"      ,label:"Phone"      ,type:"string"}
            ,{id:"City"       ,label:"City"       ,type:"string"}
            ,{id:"Geo"        ,label:"St"         ,type:"string"}
         // ,{id:"Geo"        ,label:"Geo"        ,type:"string"}
            ,{id:"Notes"      ,label:"Notes"      ,type:"string"}];
    dt.rows=[];while(result.hasNext()){r=result.next();if(r.owner){own=r.owner.slice(0,4)}else{/*continue;*/own="none";}link="<a target='_blank' title='"+r.history+"' href='https://sites.google.com/site/gosalespro/products/mojo?z="+r.getId().rc4Encrypt("IDQfyT21I1").hexEncode()+"'>click</a>";if(r.history){notelink=link+"<span title='"+r.history+"'> "+r.history.slice(0,100)+"</span>"}else{notelink=""}//dt=[['Country code','Population','Density'],['CN',1322970000,137],['IN',1130130000,336],['US',303605941,31],['ID',231627000,117],['BR',186315468,22],['PK',162652500,198],['BD',158665000,1045],['NG',148093000,142],['RU',141933955,8.4],['JP',127790000,339]];//dt=[['Country code','Population','Density'],['CA',36553215,83.85],['TX',23904380,30.75],['NY',19297729,155.18],['FL',18251243,114.43],['IL',12852548,86.27],['PA',12432792,105.8],['OH',11466917,107.05],['MI',10071822,67.55],['GA',9544750,54.59],['NC',9061032,63.8]];
    dt.rows.push({c:[{v:                 i++                                          }     // ID
                    ,{v:                 link                                         }     // Link
                    ,{v:                 own                                          }     // Own
                 // ,{v:               r.regionName                                   }     // Region
                    ,{v:(Math.floor((d-r.latestSubmit)/(1000*60*60*24))||-1)          }     // Pre
                    ,{v:(Math.floor((d-r.latestEmail )/(1000*60*60*24))||-1)          }     // E
                    ,{v:(Math.floor((  r.callback-d  )/(1000*60*60*24))|| 0)          }     // Nex
                    ,{v:               r.temperature                   ||""           }     // Temperature
                    ,{v:               r.disposition                   ||""           }     // Disposition
                    ,{v:               r.name                                         }     // Company
                    ,{v:               r.phone                                        }     // Phone
                    ,{v:               r.city                                         }     // City
                    ,{v:         "US-"+r.state                              ,f:r.state}     // St
                 // ,{v:         "US-"+r.state                                        }     // Geo
                    ,{v:                 notelink                                     }]})} // Notes
    return ContentService.createTextOutput("drawVisualization("+JSON.stringify(dt)+")").setMimeType(ContentService.MimeType.JSON)} // return ContentService.createTextOutput("google.visualization.Query.setResponse({version:'0.6',status:'ok',table:"+JSON.stringify(dt)+"})").setMimeType(ContentService.MimeType.JSON)} // var temp="// Data table response"+"/n"+"google.visualization.Query.setResponse({\"version\":\"0.6\",\"status\":\"ok\",\"sig\":\"1664774139\",\"table\":{\"cols\":[{\"id\":\"A\",\"label\":\"A - Name\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"B\",\"label\":\"B - Department\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"C\",\"label\":\"C - Country\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"D\",\"label\":\"D - Continenet\",\"type\":\"string\",\"pattern\":\"\"},{\"id\":\"E\",\"label\":\"E - Expanes\",\"type\":\"number\",\"pattern\":\"#0.###############\"},{\"id\":\"F\",\"label\":\"Revenue\",\"type\":\"number\",\"pattern\":\"#0.###############\"},{\"id\":\"G\",\"label\":\"G - Adoption\",\"type\":\"number\",\"pattern\":\"#0.###############\"}],\"rows\":[{\"c\":[{\"v\":\"Josh\"},{\"v\":\"Food\"},{\"v\":\"China\"},{\"v\":\"Asia\"},{\"v\":5000.0,\"f\":\"5000\"},{\"v\":12000.0,\"f\":\"12000\"},{\"v\":58.0,\"f\":\"58\"}]},{\"c\":[{\"v\":\"Joe\"},{\"v\":\"Food\"},{\"v\":\"India\"},{\"v\":\"Asia\"},{\"v\":6500.0,\"f\":\"6500\"},{\"v\":52000.0,\"f\":\"52000\"},{\"v\":89.0,\"f\":\"89\"}]},{\"c\":[{\"v\":\"Gili\"},{\"v\":\"Cloths\"},{\"v\":\"United States\"},{\"v\":\"America\"},{\"v\":5900.0,\"f\":\"5900\"},{\"v\":36900.0,\"f\":\"36900\"},{\"v\":97.0,\"f\":\"97\"}]},{\"c\":[{\"v\":\"Peter\"},{\"v\":\"Food\"},{\"v\":\"Indonesia\"},{\"v\":\"Asia\"},{\"v\":2300.0,\"f\":\"2300\"},{\"v\":12000.0,\"f\":\"12000\"},{\"v\":65.0,\"f\":\"65\"}]},{\"c\":[{\"v\":\"Moshes\"},{\"v\":\"Food\"},{\"v\":\"Brazil\"},{\"v\":\"America\"},{\"v\":2980.0,\"f\":\"2980\"},{\"v\":50222.0,\"f\":\"50222\"},{\"v\":59.0,\"f\":\"59\"}]},{\"c\":[{\"v\":\"Gram\"},{\"v\":\"Food\"},{\"v\":\"Pakistan\"},{\"v\":\"Asia\"},{\"v\":2700.0,\"f\":\"2700\"},{\"v\":89777.0,\"f\":\"89777\"},{\"v\":80.0,\"f\":\"80\"}]},{\"c\":[{\"v\":\"Nickol\"},{\"v\":\"Cloths\"},{\"v\":\"Bangladesh\"},{\"v\":\"Asia\"},{\"v\":6500.0,\"f\":\"6500\"},{\"v\":58000.0,\"f\":\"58000\"},{\"v\":89.0,\"f\":\"89\"}]},{\"c\":[{\"v\":\"Avraham\"},{\"v\":\"Food\"},{\"v\":\"Nigeria\"},{\"v\":\"Africa\"},{\"v\":9000.0,\"f\":\"9000\"},{\"v\":32000.0,\"f\":\"32000\"},{\"v\":83.0,\"f\":\"83\"}]},{\"c\":[{\"v\":\"Dani\"},{\"v\":\"Cloths\"},{\"v\":\"Russia\"},{\"v\":\"Asia\"},{\"v\":7000.0,\"f\":\"7000\"},{\"v\":69000.0,\"f\":\"69000\"},{\"v\":87.0,\"f\":\"87\"}]},{\"c\":[{\"v\":\"Mili\"},{\"v\":\"Cloths\"},{\"v\":\"Japan\"},{\"v\":\"Asia\"},{\"v\":3240.0,\"f\":\"3240\"},{\"v\":64000.0,\"f\":\"64000\"},{\"v\":80.0,\"f\":\"80\"}]},{\"c\":[{\"v\":\"Toni\"},{\"v\":\"Food\"},{\"v\":\"England\"},{\"v\":\"Europe\"},{\"v\":2100.0,\"f\":\"2100\"},{\"v\":12000.0,\"f\":\"12000\"},{\"v\":95.0,\"f\":\"95\"}]},{\"c\":[{\"v\":\"Bill\"},{\"v\":\"Food\"},{\"v\":\"Franch\"},{\"v\":\"Europe\"},{\"v\":0.0,\"f\":\"0\"},{\"v\":98000.0,\"f\":\"98000\"},{\"v\":45.0,\"f\":\"45\"}]},{\"c\":[{\"v\":\"Tivoli\"},{\"v\":\"Food\"},{\"v\":\"Sudan\"},{\"v\":\"Africa\"},{\"v\":3290.0,\"f\":\"3290\"},{\"v\":18000.0,\"f\":\"18000\"},{\"v\":80.0,\"f\":\"80\"}]}]}});";//return ContentService.createTextOutput(temp).setMimeType(ContentService.MimeType.JSON)}
function serveCalendar(){var START_YR=2006,ARR=[,"January","February","March","April","May","June","July","August","September","October","November","December"],d=new Date(),yr=d.getFullYear(),mo=d.getMonth()+1,ob=[],i,q,r,id,record,user=Session.getUser().getEmail(),db=ScriptDb.getMyDb(),out={"totalResultsCount":0,"records":[]};
    while(yr>START_YR){if(!--mo){mo=12;yr--;}q={table:"report",source:user/*Replace with company_id*/,year:yr,monthNum:mo};
        if(db.query(q).getSize()){r=db.query(q).next();}else{q.monthStr=ARR[mo];q.sortBy=1000*yr+mo;q.roi=[{timestamp:d.getTime(),amt:""}];r=db.load(db.save(q).getId());}
        out.records.push({
                    "db_id"              : function(){try{return LibraryjsUtil.rc4Encrypt("DktaE",r.getId())                             }catch(e){Logger.log("Error iurCY: "+e.message);return "";}}() //
                ,   "sortBy"             : function(){try{return                                  r.sortBy                               }catch(e){Logger.log("Error RMvQM: "+e.message);return "";}}() //
                ,   "year"               : function(){try{return                                  r.year                                 }catch(e){Logger.log("Error 3hBxC: "+e.message);return "";}}() //
                ,   "monthNum"           : function(){try{return                                  r.monthNum                             }catch(e){Logger.log("Error 4xnhC: "+e.message);return "";}}() //
                ,   "monthStr"           : function(){try{return                                  r.monthStr                             }catch(e){Logger.log("Error tqRYj: "+e.message);return "";}}() //
                ,   "roi"                : function(){try{return                                  r.roi[0].amt                           }catch(e){Logger.log("Error RdKOP: "+e.message);return "";}}() //
		        });}out.totalResultsCount=out.records.length;Logger.log(JSON.stringify(out));return out;}
function t_serveCalendar(){var START_YR=2006,ARR=[,"January","February","March","April","May","June","July","August","September","October","November","December"],d=new Date(),t=d.getTime(),yr=d.getFullYear(),mo=d.getMonth()+1,ob=[],i,q,qr,rq,r,id,out={"totalResultsCount":0,"records":[]},user=Session.getUser().getEmail(),db=ScriptDb.getMyDb(),q={table:"report",source:user/*Replace with company_id*/},results=db.query(q);while(results.hasNext()){rq=results.next();
    while(yr>START_YR){if(!--mo){mo=12;yr--;}
        /*try{*/if(rq.year==yr&rq.monthNum==mo){r=rq}/*}*catch(e)*/else{qr=q;qr.monthStr=ARR[mo];qr.sortBy=1000*yr+mo;qr.roi=[{timestamp:t,amt:""}];r=db.load(db.save(qr).getId());}
        out.records.push({
                    "db_id"              : function(){try{return LibraryjsUtil.rc4Encrypt("DktaE",r.getId())                             }catch(e){Logger.log("Error St5Tf: "+e.message);return "";}}() //
                ,   "sortBy"             : function(){try{return                                  r.sortBy                               }catch(e){Logger.log("Error SDdnN: "+e.message);return "";}}() //
                ,   "year"               : function(){try{return                                  r.year                                 }catch(e){Logger.log("Error ETGkj: "+e.message);return "";}}() //
                ,   "monthNum"           : function(){try{return                                  r.monthNum                             }catch(e){Logger.log("Error Ekqld: "+e.message);return "";}}() //
                ,   "monthStr"           : function(){try{return                                  r.monthStr                             }catch(e){Logger.log("Error mG5t6: "+e.message);return "";}}() //
                ,   "roi"                : function(){try{return                                  r.roi[0].amt                           }catch(e){Logger.log("Error 7WCWD: "+e.message);return "";}}() //
		        });}}out.totalResultsCount=out.records.length;/*Logger.log(JSON.stringify(out));*/return out;}
function serveMarquee(){}
-------------------------------------- form.html (a template kit for implementing forms; must be unpacked) --------------------------------------
function processForm(formObject){var formBlob=formObject.myFile,driveFile=DriveApp.createFile(formBlob);return driveFile.getUrl()} // Goes in Code.gs // Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms
<form id="myForm"><input name="myFile" type="file"><input type="button" value="Submit" onclick="google.script.run.withSuccessHandler(updateUrl).processForm(this.parentNode);this.parentNode.reset()"></form><div id="output"></div><script>function updateUrl(url){document.getElementById("output").innerHTML='<a href="'+url+'">Got it!</a>'}</script><!--Goes in index.html; Reference: https://developers.google.com/apps-script/guides/html/communication#forms-->
-------------------------------------- sell.html --------------------------------------
<meta charset="utf-8"/>
<div style="font-family:arial;font-size:75%;color:#777777;">
    <form id="form_reg" style="background:grey;padding:6px;border:2px solid #DDDDDD;border-radius:8px;"><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms--><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <span style="font-weight:bold">
        Seller Info</span> | <!-- Load user data via google.script.run.withSuccessHandler(populateUser).sendUserToClient(); Reference: https://developers.google.com/apps-script/guides/html-service-communication#success_handlers -->
        Full name      <input type="text"   style="color:#777777" id="fullname"        name="fullname">
        Phone          <input type="tel"    style="color:#777777" id="phone"           name="phone" pattern="^\d{10}$"  size="8" maxlength="10" title="Area code. No punctuation. Example: 2125551234">
        Email list     <input type="text"   style="color:#777777" id="emailListString" name="emailListString" size="50" title="List of email addresses to notify. Separate with comma. Separately process list as text file. Then copy and paste.">
        Ask            <select              style="color:#777777" id="ask"             name="ask" size="1" title="EARN — How many points do you ask others to pay you to broker note sales to your existing buyer pool?"><option></option><option>0.00</option><option>0.25</option><option>0.50</option><option>0.75</option><option>1.00</option><option>1.25</option><option>1.50</option><option>1.75</option><option>2.00</option><option>3.25</option><option>3.50</option><option>3.75</option><option>3.00</option><option>4.25</option><option>4.50</option><option>4.75</option><option>5.00</option><option>6.25</option><option>6.50</option><option>6.75</option><option>7.00</option><option>7.25</option><option>7.50</option><option>7.75</option><option>8.00</option><option>8.25</option><option>8.50</option><option>8.75</option><option>9.00</option><option>9.25</option><option>9.50</option><option>9.75</option><option>10.00</option></select>
        Bid            <select              style="color:#777777" id="bid"             name="bid" size="1" title="PAY — How many points do you offer to have others sell notes on your behalf to their buyer pool?"><option></option><option>0.00</option><option>0.25</option><option>0.50</option><option>0.75</option><option>1.00</option><option>1.25</option><option>1.50</option><option>1.75</option><option>2.00</option><option>3.25</option><option>3.50</option><option>3.75</option><option>3.00</option><option>4.25</option><option>4.50</option><option>4.75</option><option>5.00</option><option>6.25</option><option>6.50</option><option>6.75</option><option>7.00</option><option>7.25</option><option>7.50</option><option>7.75</option><option>8.00</option><option>8.25</option><option>8.50</option><option>8.75</option><option>9.00</option><option>9.25</option><option>9.50</option><option>9.75</option><option>10.00</option></select>
                       <input type="checkbox" name="agreed" id="agreed" value=true>I agree to the <a target="_blank" href="https://docs.google.com/document/d/1X8E5xzWGtGyUOy1PmAkwJ51vU6qX12rxUF8JjhpWRUU/preview">Groundrules</a>.               
                       <input type="button" value="Update" onclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_registerSeller(this.parentNode)">
    </form><br>
    <form id="form_note" style="background:grey;padding:6px;border:2px solid #DDDDDD;border-radius:8px;"><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms--><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <span style="font-weight:bold">Loan Data</span>
                       <input type="button" value="Submit" onclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_addNote(this.parentNode)">
                       <input type="button" value="Reset"  onclick="google.script.run.withSuccessHandler(resetForm   ).withUserObject(this).auth               (this.parentNode)">
    <table><tbody><tr><td>
        <img height="20" src="https://lh5.googleusercontent.com/-VYG_HrGX_ms/U3HJnMmX7lI/AAAAAAAALQw/MkOY_wmlD9Y/s144/orange.png"></td><td>
        <span style="font-style:italic">Terms</span></td><td>|
        AskPrice       <input type="text"   style="color:#777777" name="askPrice"   size="1" value=""          title="Total cash price you are asking to buyer to pay you to purchase the note. No commas. Round decimals. Example: 102500">
        AskRate        <input type="text"   style="color:#777777" name="askRate"    size="1" value=""          title="Interest rate paid to note buyer. Example: 13">
        BorRate        <input type="text"   style="color:#777777" name="borRate"    size="1" value=""          title="Interest rate paid by borrower. Example: 15">
        BorPts         <input type="text"   style="color:#777777" name="borPts"     size="1" value=""          title="Points paid by borrower. Example: 3">
        Status         <select              style="color:#777777" name="loanStatus" size="1" value=""          title="P=Performing | N=Non-Performing | O=Newly originated (seeking funding)">
                           <option></option>
                           <option>P</option>
                           <option>N</option>
                           <option>O</option>
                       </select>
        LienPos        <select              style="color:#777777" name="lienPos"    size="1" value=""          title="Lien position: 1st, 2nd, 3rd or Other">
                           <option></option>
                           <option>1</option>
                           <option>2</option>
                           <option>3</option>
                           <option>O</option>
                       </select>
        OrigDate       <input type="date"          style="color:#777777;font-family:arial" name="dateOrig"     title="Origination date">
                   <!--<select id="dateOrig_mo"    style="color:#777777" name="dateOrig_mo" ><option></option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
                       <select id="dateOrig_day"   style="color:#777777" name="dateOrig_day"><option></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option></select>
                       <select id="dateOrig_yr"    style="color:#777777" name="dateOrig_yr" ><option></option><option>2022</option><option>2021</option><option>2020</option><option>2019</option><option>2018</option><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option><option>2011</option><option>2010</option><option>2009</option><option>2008</option><option>2007</option><option>2006</option><option>2005</option><option>2004</option></select>-->
        BegBal         <input type="text"   style="color:#777777" name="balBeg"     size="3" value=""          title="Original loan amount and beginning balance. Omit dollar signs and commas. Example: 124250">
        CurBal         <input type="text"   style="color:#777777" name="balCur"     size="3" value=""          title="Current Unpaid Principal Balance. Omit dollar signs and commas. Example: 104250">
   <!-- LTV%           <input type="text"   style="color:#777777" name="pctLtv"     size="1"                   title="Loan amount (defined as: unpaid principal balance) to “as-is” value of the collateral. Example: 65">
        %UPB           <input type="text"   style="color:#777777" name="pctUpb"     size="1"                   title="Pct of Unpaid Principal Balance. Example: 65">
        Note: percentages might or might not be stored as independent field values but, rather, calculated at the time of presentation
        DownPmt        <input type="text"   style="color:#777777" name="downPmt"    size="3" value=""          title="Down payment">
        Term           <input type="text"   style="color:#777777" name="term"       size="1"                   title="Term to maturity (when first written) in months. Example: 18">
        Sell     <input type="radio"  style="color:#777777" name="exit"                value="sell"      title="Sell" >
        Refi     <input type="radio"  style="color:#777777" name="exit"                value="refinance" title="Refinance"> |
        SellCarry      <input type="text"   style="color:#777777" name="sellCarry"  size="3"                   title="Seller carryback financing. If any. Example: 125000">
        Type           <select id="use"     style="color:#777777" name="type"       size="1"                   title="Type of debt instrument">
			     		   <option></option>
						   <option>Promissory Note  </option>
					       <option>Land Contract    </option>
					       <option>Contract for Deed</option>
				     	   <option>Business Note    </option>
                       </select>
        What Type of Payout Are You Seeking?
                       <select             style="color:#777777" name="Type of Payment">
			               <option></option>
					       <option>Full Payment    </option>
					       <option>Partial Payment </option>
                       </select>
        Property Description <textarea           name="Special Clauses"    cols="25" rows="4"  ></textarea>
        Reason for Selling?  <textarea           name="Reason for Selling" cols="25" rows="4"  ></textarea> --></td></tr><tr><td><img height="20" src="https://lh6.googleusercontent.com/-Y4oO2vxR9QY/UddvvsSQ-RI/AAAAAAAAHXA/iSSy0VYVTsU/s144/Coin-icon.png">
        </td><td><span style="font-style:italic">Payments</span></td><td>|
   <!-- PmtsRecd       <input type="text"          style="color:#777777" name="pmtsRecd"    size="1" value="" title="Number of payments made so far">
        PmtsLeft       <input type="text"          style="color:#777777" name="pmtsLeft"    size="1" value="" title="Number of payments remaining"> -->
        PmtAmt         <input type="text"          style="color:#777777" name="pmtAmt"      size="1" value="" title="Payment amount">
                       <span  title="Date of latest payment made">
        PaidTo         <input type="date"          style="color:#777777;font-family:arial" name="datePaidTo"  title="Date most recent full monthly payment was made">
                   <!--<select id="datePaidTo_mo"  style="color:#777777" name="datePaidTo_mo" ><option></option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
                       <select id="datePaidTo_day" style="color:#777777" name="datePaidTo_day"><option></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option></select>
                       <select id="datePaidTo_yr"  style="color:#777777" name="datePaidTo_yr" ><option></option><option>2022</option><option>2021</option><option>2020</option><option>2019</option><option>2018</option><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option><option>2011</option><option>2010</option><option>2009</option><option>2008</option><option>2007</option><option>2006</option><option>2005</option><option>2004</option></select>-->
                       </span>
        NextDue        <input type="date"          style="color:#777777;font-family:arial" name="dateNext"    title="Due date of next payment. If in default, indicate the date in the past.">
                   <!--<select id="dateNext_mo"    style="color:#777777" name="dateNext_mo" ><option></option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
                       <select id="dateNext_day"   style="color:#777777" name="dateNext_day"><option></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option></select>
                       <select id="dateNext_yr"    style="color:#777777" name="dateNext_yr" ><option></option><option>2022</option><option>2021</option><option>2020</option><option>2019</option><option>2018</option><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option><option>2011</option><option>2010</option><option>2009</option><option>2008</option><option>2007</option><option>2006</option><option>2005</option><option>2004</option></select>-->
        Balloon        <select                     style="color:#777777" name="balloon"              value="" title="Does this loan have a balloon payment due at maturity date?">
                           <option></option>
                           <option>Yes</option>
                           <option>No </option>
                       </select>
        BallAmt        <input  type="text"           style="color:#777777"                   name="ballAmt" size="1" value="" title="Balloon amount (if any)">
        MaturityDate   <input  type="date"           style="color:#777777;font-family:arial" name="dateMaturity" title="Maturity date">
                   <!--<select id="dateMaturity_mo"  style="color:#777777" name="dateMaturity_mo" ><option></option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
                       <select id="dateMaturity_day" style="color:#777777" name="dateMaturity_day"><option></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option></select>
                       <select id="dateMaturity_yr"  style="color:#777777" name="dateMaturity_yr" ><option></option><option>2022</option><option>2021</option><option>2020</option><option>2019</option><option>2018</option><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option><option>2011</option><option>2010</option><option>2009</option><option>2008</option><option>2007</option><option>2006</option><option>2005</option><option>2004</option></select>-->
        </td></tr><tr><td>
        <img height="20" src="https://lh3.googleusercontent.com/-ZlfH3NUq_Fk/UZp0VmzWR3I/AAAAAAAAGlo/AnKdcLDMfZU/s144/home_house_building.png" xsrc="https://lh3.googleusercontent.com/-ZlfH3NUq_Fk/UZp0VmzWR3I/AAAAAAAAGlo/AnKdcLDMfZU/s144/home_house_building.png"></td><td>
        <span style="font-style:italic">Collateral</span></td><td>
        | <span style="font-style:italic">Facts</span> |
        Street         <input type="text"   style="color:#777777" name="sa"                                    title="Example: 123 Main St">
        City           <input type="text"   style="color:#777777" name="city"                                  title="Example: Cambridge">
        State          <input type="text"   style="color:#777777" name="state"      size="1"                   title="Example: MA">
        Zip            <input type="text"   style="color:#777777" name="zip"        size="2"  maxlength="5"    title="Example: 02139">
        Use        <!--<input type="text"   style="color:#777777" name="use"                                   title="Example: Single Family Residence">-->
                       <select id="use"     style="color:#777777" name="use"        size="1"                   title="SFR: Single Family Residential" onchange="">
                           <option></option>
                           <option>SFR        </option>
                           <option>Condo      </option>
					       <option>Duplex     </option>
			               <option>Triplex    </option>
					       <option>Fourplex   </option>
				     	   <option>Land Only  </option>
                           <option>Mobile Home</option>
                           <option>Mobile+Land</option>
	     				   <option>Apartment  </option>
                           <option>Commercial </option>
					       <option>Portfolio  </option>
                       </select>
        Beds           <input type="text"      style="color:#777777" name="beds"       size="1"                title="Bedrooms. Example: 2">
        Baths          <input type="text"      style="color:#777777" name="baths"      size="1"                title="Bathrooms. Use decimals when necessary. Example: 2.25">
        Sqft           <input type="text"      style="color:#777777" name="sqft"       size="1"                title="Square feet. No commas. Example: 1175">
        <br>
        | <span style="font-style:italic">Value</span> |
        SalePrice      <input type="text"      style="color:#777777" name="purPrice"   size="3"                title="Purchase price. If purchase money loan. Example: 145000">
        ARV            <input type="text"      style="color:#777777" name="arv"        size="3"                title="After repair value. No commas. Example: 210000">
        EstValue       <input type="text"      style="color:#777777" name="estValue"   size="3"                title='Estimated value (“as-is”). Example: 145000'>
        EstMethod      <select  id="estMethod" style="color:#777777" name="estMethod"  size="1"                title="Method of estimating value">
                           <option></option>
                           <option>Appraisal</option>
                           <option>BPO</option>
                           <option>CMA</option>
                           <option>Automated</option>
                           <option>Other</option>
                       </select>
        EstDate        <input type="date"          style="color:#777777;font-family:arial" name="estDate"      title="Date of value estimate">
                   <!--<select id="estDate_mo"  style="color:#777777" name="estDate_mo" ><option></option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option></select>
                       <select id="estDate_day" style="color:#777777" name="estDate_day"><option></option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option></select>
                       <select id="estDate_yr"  style="color:#777777" name="estDate_yr" ><option></option><option>2022</option><option>2021</option><option>2020</option><option>2019</option><option>2018</option><option>2017</option><option>2016</option><option>2015</option><option>2014</option><option>2013</option><option>2012</option><option>2011</option><option>2010</option><option>2009</option><option>2008</option><option>2007</option><option>2006</option><option>2005</option><option>2004</option></select>-->
        </td></tr><tr><td><img height="20" src="https://lh5.googleusercontent.com/-EU9GD4Y2hjk/U6n8XFTjcYI/AAAAAAAAL9Q/v26gOEX8Dfo/s144/business_user.png">
                 </td><td><span style="font-style:italic">Borrower</span></td><td>|
        Purpose    <!--<input type="text"   style="color:#777777" name="purpose"                               title="Example: Refinance">-->
                       <select  id="purpose" style="color:#777777" name="purpose"    size="1"                  title="" onchange="">
                           <option></option>
                           <option>Purchase</option>
                           <option>Refinance</option>
                       </select>
         <!-- Purchase <input type="radio"  style="color:#777777" name="purpose"             value="purchase"  title="Purchase money"        >
              Refi     <input type="radio"  style="color:#777777" name="purpose"             value="refinance" title="Refinance or cash out"  > | -->
        Exit       <!--<input type="text"   style="color:#777777" name="exit"                                  title="Exit strategy. Examples: Refi, Sell, Flip, etc." >   -->
                       <select  id="exit"   style="color:#777777" name="exit"       size="1"                   title="" onchange="">
                           <option></option>
                           <option>Sell</option>
                           <option>Refi</option>
                       </select>
        N/OO           <select              style="color:#777777" name="occ"        size="1" value=""          title="OO = Owner-occupied. NOO = Non-owner-occupied">
	                       <option></option>
                           <option>OO </option>
                           <option>NOO</option>
                       </select>
        GoodPay        <input type="text"          style="color:#777777" name="payGood"    size="1"                   title='Borrower “Good Pay” track record history with your company. Enter how many loans the borrower has successfully repaid to your company. Example: 10'>
        BadPay         <input type="text"          style="color:#777777" name="payBad"     size="1"                   title='Borrower “Bad Pay” history. Enter number of prior loan defaults with your company. Example: 0'>
        SchedRE        <input type="text"          style="color:#777777" name="schedRE"    size="1"                   title='Enter number of properties the borrower currently has in inventory i.e., “Schedule of Real Estate.” Example: 10'>
        Highlights     <input type="text"          style="color:#777777" name="notes"      size="50"                  title="Deal summary and/or highlights. Example: 1. Borrower purchased through short sale in August. 2. Borrower has updated property. 3. Borrower has tenant with good cash flow of $1,500/month. 4. Repeat Borrower in good standing with company with one loan paid off. Hot tip: Edit separately then copy/paste into this box.">
   <!-- Occupation     <input type="text"          style="color:#777777" name="occupation" size="1" value=""          title="Borrower's occupation">
        Credit         <select                     style="color:#777777" name="borCredit"                             title="Borrower's credit">
			     		   <option></option>
		                   <option>700+    </option>
			     		   <option>650-699 </option>
			     		   <option>600-649 </option>
			     		   <option>Under600</option>
                       </select> -->
        </td></tr><tr><td><img height="15" src="https://lh6.googleusercontent.com/-2qPIYPcOdgI/UdejzhK8c1I/AAAAAAAAHhc/4uyoIExqRzs/s144/yf.png">
        </td><td><span style="font-style:italic" title="Check the documents you include in the file packet you upload below">Docs</span></td><td>|
                       <input type="checkbox" name="doc_note"      unchecked  title="Copy of Note"            >Note
					   <input type="checkbox" name="doc_closing"   unchecked  title="Escrow Closing Statement">Close
					   <input type="checkbox" name="doc_hazard"    unchecked  title="Current Hazard Insurance">Hazard
					   <input type="checkbox" name="doc_title"     unchecked  title="Title Insurance"         >Title
				       <input type="checkbox" name="doc_pmts"      unchecked  title="Payment Records"         >Payments
				       <input type="checkbox" name="doc_appraisal" unchecked  title="Appraisal"               >Appraisal
					   <input type="checkbox" name="doc_pics"      unchecked  title="Current Pictures"        >Photos
                       <span style="margin-left:10px;margin-right:10px;">&#10151;</span>
        Image          <input type="file"     name="filePic"                                                   title="Upload picture of subject">
        Docs           <input type="file"     name="fileDoc"                                                   title='Upload “deal stack” (as PDF file)'>    
    </td></tr></tbody></table>
    </form>
</div>
<!-- --------------------- Put script tags below this line. --------------------- -->
<!-- Reference: https://developers.google.com/apps-script/guides/html-service-best-practices?hl=en#load_javascript_last -->
<!-- Reference: https://developers.google.com/apps-script/guides/html-service-best-practices?hl=en#dont_use_html_head_or_body_tags --><!-- Dont use <html>, <head> or <body> tags; -->
<script>function updateButton(userObject,button){if(!document.getElementById("agreed").checked){alert('To proceed: \n 1. Please check the box that indicates your agreement to the Groundrules! \n 2. Press the "Update Seller Info" pdate button again.')}else{button.value="Success!";alert("Success!");}}</script>
<script>function resetForm   (userObject,button){if(!ScriptDb.getMyDb().query({table:"user",user:Session.getActiveUser().getEmail(),seller:true}).next().agreed){alert('To proceed: \n 1. Please check the box that indicates your agreement to the Groundrules! \n 2. Press the "Update Seller Info" pdate button again.')}else{document.getElementById("form_note").reset();}}</script>
<script>function populateUser(u){var ob=u.record[0]||{agreed:false},keys=Object.keys(ob),i=keys.length;
                                 document.getElementById("agreed").checked=ob.agreed; // Keep this instruction in front of the below value setting loop. For reasons not clearly understood, this line does not work if placed after the value setting loop.
                                 while(i--){try{if(ob&&ob[keys[i]]){document.getElementById(keys[i]).value=ob[keys[i]]}}catch(e){/*Logger.log(e.message)*//*Never write to logger on HTML page*/}}}
        google.script.run.withSuccessHandler(populateUser).sendUserToClient();
</script>
<!--
Loan Scenarios to add:
1. Money held in trust for rehab.
2. Multiple properties / cross-collateralization
-->
-------------------------------------- buy.html --------------------------------------
Blank
-------------------------------------- sell01.html --------------------------------------
<div style="font-family:arial;font-size:75%;color:#777777;">
    <form id="form_reg"><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms--><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <span style="font-weight:bold">
        Seller Info</span> | <!-- Load user data via google.script.run.withSuccessHandler(populateUser).sendUserToClient(); Reference: https://developers.google.com/apps-script/guides/html-service-communication#success_handlers -->
        Full name      <input type="text"   style="color:#777777" name="fullname" id="fullname">
        Phone          <input type="text"   style="color:#777777" name="phone" id="phone" pattern="^\d{10}$" size="8" maxlength="10" title="Area code. No punctuation. Example: 2125551234">
        Email list     <input type="text"   style="color:#777777" name="emailListString" id="emailListString" size="50" title="List of email addresses to notify. Separate with comma. Separately process list as text file. Then copy and paste.">
                       <input type="button" value="Update Contact Info" onclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_registerSeller(this.parentNode)">
    </form>
    <form id="form_note"><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms--><!--Reference: https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <span style="font-weight:bold">
        [+] Add New Note </span> |
        <span style="font-style:italic">Loan</span> | 
        BuyRate        <input type="text"   style="color:#777777" name="buyRate"   size="1"                   title="Interest rate paid to note buyer. Example: 13">
        BuyPts         <input type="text"   style="color:#777777" name="buyPts"    size="1"                   title="Points paid to note buyer. Example: 1.5">
        BorRate        <input type="text"   style="color:#777777" name="borRate"   size="1"                   title="Interest rate paid by borrower. Example: 15">
        BorPts         <input type="text"   style="color:#777777" name="borPts"    size="1"                   title="Points paid by borrower. Example: 3">
        Amount         <input type="text"   style="color:#777777" name="amount"    size="3"                   title="Example: 94250">
        LTV%           <input type="text"   style="color:#777777" name="ltv"       size="1"                   title="Example: 65">
        Term           <input type="text"   style="color:#777777" name="term"      size="1"                   title="In months. Example: 18">
        Purpose    <!--<input type="text"   style="color:#777777" name="purpose"                              title="Example: Refinance">-->
                       <select  id="type"   style="color:#777777" name="purpose"   size="1"                   title="" onchange="">
                           <option></option>
                           <option>Purchase</option>
                           <option>Refinance</option>
                       </select>
         <!-- Purchase <input type="radio"  style="color:#777777" name="purpose"            value="purchase"  title="Purchase money"        >
              Refi     <input type="radio"  style="color:#777777" name="purpose"            value="refinance" title="Refinance or cash out"  > | -->
        Exit       <!--<input type="text"   style="color:#777777" name="exit"                                 title="Exit strategy. Examples: Refi, Sell, Flip, etc." >   -->
                       <select  id="exit"   style="color:#777777" name="exit"      size="1"                   title="" onchange="">
                           <option></option>
                           <option>Sell</option>
                           <option>Refi</option>
                       </select>
         <!-- Sell     <input type="radio"  style="color:#777777" name="exit"               value="sell"      title="Sell"                   >
              Refi     <input type="radio"  style="color:#777777" name="exit"               value="refinance" title="Refinance"> | -->
        Notes          <input type="text"   style="color:#777777" name="notes"     size="1"                   title="Deal highlights. Example: 1. Borrower purchased through short sale in August. 2. Borrower has updated property. 3. Borrower has tenant with good cash flow of $1,500/month. 4. Repeat Borrower in good standing with company with one loan paid off.">
        SellCarry      <input type="text"   style="color:#777777" name="sellCarry" size="3"                   title="Seller carryback financing. If any. Example: 125000">
   <br> <span style="font-style:italic">Collateral</span> |
        Street         <input type="text"   style="color:#777777" name="sa"                                   title="Example: 123 Main St">
        City           <input type="text"   style="color:#777777" name="city"                                 title="Example: Cambridge">
        State          <input type="text"   style="color:#777777" name="state"     size="1"                   title="Example: MA">
        Zip            <input type="text"   style="color:#777777" name="zip"       size="2"                   title="Example: 02139">
        Use        <!--<input type="text"   style="color:#777777" name="use"                                  title="Example: Single Family Residence">-->
                       <select id="use"     style="color:#777777" name="use"       size="1"                   title="SFR: Single Family Residential" onchange="">
                           <option></option>
                           <option>SFR</option>
                           <option>Condo</option>  
                           <option>2-4</option>
                           <option>Apt</option>
                       </select>
        Beds           <input type="text"   style="color:#777777" name="beds"      size="1"                   title="Example: 2">
        Baths          <input type="text"   style="color:#777777" name="baths"     size="1"                   title="Use decimals when necessary. Example: 2.25">
        Sqft           <input type="text"   style="color:#777777" name="sqft"      size="1"                   title="No commas. Example: 1175">
        ARV            <input type="text"   style="color:#777777" name="arv"       size="3"                   title="No commas. Example: 210000">
        Appraisal      <input type="text"   style="color:#777777" name="appraisal" size="3"                   title="As is. Example: 145000">
        PurPrice       <input type="text"   style="color:#777777" name="purPrice"  size="3"                   title="Purchase price. If purchase money loan. Example: 145000">
   <br> Image          <input type="file"                         name="filePic"                              title="Picture of subject">
        Documents      <input type="file"                         name="fileDoc"                              title='Deal “stack” as PDF file'>    
                       <input type="button" value="Submit New Note" onclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_addNote(this.parentNode)">
                       <input type="button" value="Reset Form"      onclick="google.script.run.withSuccessHandler(resetForm)   .withUserObject(this).auth               (this.parentNode)">
    </form>
</div>
<!-- --------------------- Put script tags below this line. --------------------- -->
<!-- Reference: https://developers.google.com/apps-script/guides/html-service-best-practices?hl=en#load_javascript_last -->
<!-- Reference: https://developers.google.com/apps-script/guides/html-service-best-practices?hl=en#dont_use_html_head_or_body_tags --><!-- Dont use <html>, <head> or <body> tags; -->
<script>function updateButton(userObject,button){document.getElementById("form_note").reset();button.value="Success!";}</script>
<script>function resetForm   (userObject,button){document.getElementById("form_note").reset();                        }</script>
<script>function populateUser(r){try{if(r.record[0]&&r.record[0].fullname       ){document.getElementById("fullname"       ).value=r.record[0].fullname       }}catch(e){Logger.log("Error sKmN3: "+e.message)}
                                 try{if(r.record[0]&&r.record[0].phone          ){document.getElementById("phone"          ).value=r.record[0].phone          }}catch(e){Logger.log("Error GzlA7: "+e.message)}
                                 try{if(r.record[0]&&r.record[0].emailListString){document.getElementById("emailListString").value=r.record[0].emailListString}}catch(e){Logger.log("Error spo08: "+e.message)}}
        google.script.run.withSuccessHandler(populateUser).sendUserToClient();
</script>
<!--
Loan Scenarios to add:
1. Money held in trust for rehab.
2. Multiple properties / cross-collateralization
-->
-------------------------------------- sandbox.html --------------------------------------
<div style="font-family:arial;font-size:75%;color:#777777;">
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <div>Choose date<input type="text" name="date" id="datepicker" style="color:#777777"/></div>
    <script>$("#datepicker").datepicker();</script> <!-- // Reference: http://stackoverflow.com/questions/9336163/jquery-ui-with-google-apps-script // Search: use jquery with google apps script html service -- >
</div>