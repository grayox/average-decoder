// -- Exceptions --
// 4009 Pittwood, Danville, VA       — DataQuick returns text string
// 5200 SW 32nd St, Topeka, KS 66614 — continually runs
// -- Fixed Exceptions --
// 2865 S Meridian St, Indianapolis, In
// 605 upper st, danville, va
// 732 franklin st, westbury, ny 11590
//-------------------------------------- Resources --------------------------------------
// Schools       : http://www.greatschools.org/search/search.page?lat=40.733223&lon=-80.30786799999998&zipCode=15066&state=PA&normalizedAddress=1124%208th%20Avenue%2C%20New%20Brighton%2C%20PA%2015066&city=New%20Brighton&sortBy=DISTANCE&locationSearchString=1124%208th%20Ave%2C%20New%20Brighton%2C%20PA%2015066&distance=5
// Neighborhoods : http://www.areavibes.com/danville-va/livability/
// BPO Agents    : http://www.nabpop.org/
// Inspectors    : http://inspectorseek.com/results.php?q=seattle%2C+WA&range=40 || http://inspectorseek.com/results.php?q=24112&range=40
// Appraisors    : https://www.asc.gov/National-Registry/FindAnAppraiser.aspx
//-------------------------------------- Code.gs --------------------------------------
// JSON visualization | viewer: http://chris.photobooks.com/json/default.htm
// function getEmailQuota(){Logger.log("Remaining email quota: " + MailApp.getRemainingDailyQuota());}
// Note: to accept doPost() from affiliate, (design decision:) must set: Publish > Deploy as web app > Execute the app as: me, Who has access to the app: Anyone, even anonymous // Otherwise, script will not run at server (though, client will receive responseCode=200); client response (200) is Google accounts sign-in page/form  // Decision Benefits: 1. script runs 2. script authorization bypass (i.e., not needed at UI) // Decision Costs: 1. Looser script security; mitigated by a. Site level access restrictions/permissions b. key method (e.g., switch/case k:foo)
// Test Functions
// function test(){Logger.log(avmReportServeData(encodeURIComponent("5008 corson ave s, seattle, wa")))}
// function test(){Logger.log(avmReportServeData(                   "5008 corson ave s, seattle, wa" ))}
function auth    (){}
function timer   (){Logger.log(new Date().getTime())}//1388228703613
function backup  (){var desc="Argenta™ Backup — timestamp:"+new Date().getTime(),id,out=[],db=ScriptDb.getMyDb(),results=db.query({});while(results.hasNext()){out.unshift(results.next())}id=DriveApp.createFile(desc,JSON.stringify(out),MimeType.HTML).setDescription(desc);Logger.log(id);}
function print   (str){var desc="Argenta™ Print — timestamp:"+new Date().getTime(),id=DriveApp.createFile(desc,str,MimeType.HTML).setDescription(desc);Logger.log("Printed doc ID: "+id);}
//function print   (){var desc="Argenta™ Print — timestamp:"+new Date().getTime(),id,out=[],db=ScriptDb.getMyDb(),results=db.query({table:"note"});while(results.hasNext()){out.unshift(results.next())}id=DriveApp.createFile(desc,JSON.stringify(out),MimeType.HTML).setDescription(desc);Logger.log(id);}
function print_test(str,desc){str=str||JSON.stringify(ScriptDb.getMyDb().load("S337185323966"));desc=desc||"Argenta Print — timestamp:"+new Date().getTime();DriveApp.createFile(desc,str,MimeType.HTML);}
function size    (){var db=ScriptDb.getMyDb();Logger.log(/*ScriptDb.getMyDb()*/db.query({}).getSize());}
function showById(){Logger.log(JSON.stringify(ScriptDb.getMyDb().load("S96280679164")))} // Show one record by ID
function showOne (){Logger.log(/*Utilities.jsonStringify*/JSON.stringify(ScriptDb.getMyDb().query({item:"eXjKqn1"/*/table:"note"/* /"user",user:"atlaslive@gmail.com",seller:true/*,city:"test"*/}).next()));} // Show all records in database // Reference: https://developers.google.com/apps-script/scriptdb#saving_data
function showAll (){var db=ScriptDb.getMyDb(),r,results=db.query({});while(results.hasNext()){r=results.next();Logger.log(/*Utilities.jsonStringify*/JSON.stringify(r));return arr}} // Show all records in database // Reference: https://developers.google.com/apps-script/scriptdb#saving_data
function print2ss(){LibraryjsUtil.write2ss(true,showAll(),"Sheet1","1azZ5rq1Sgy2fipwhwd75f9M6jkzvWk4TZmOzH2A4uRg"/*act*/)}
//function del     (){var xdb=ScriptDb.getMyDb(),arr=[],r,results=db.query({xtable:"note"/*,/*source:"fciEx_foo",* /table:db.not("report"),* /timestamp_posted:db.greaterThan(1388548425377),k:"8u0hjrtbd68s3hi1w9kl",/*"36sgd2m257w2j0sn5isa",* /"report"/* /"bid"/*"user"* /,xcity:"test"/*xseller:true,xuser* /,bidder:"atlaslive@gmail.com"*/});while(results.hasNext()){arr.push(results.next().getId());}db.removeByIdBatch(arr,false);} // Replaced: while(results.hasNext()){r=results.next();db.remove(r);}}
//function mod     (){var xdb=ScriptDb.getMyDb(),arr=[],r,results=db.query({/*item* /city:true,/*db.not(db.anyValue())/*/xtable:"note"/*,pctLtv:db.between(0,1.1),lienPos:db.not(1)/*,/*use* /lienPos:db.anyOf(["1st"/*false,db.not(db.anyValue())/*"Hospitality"/*"Commercial"/*"Apt","Multifamily"* /])/*"Oth"/* /"bid"*/});while(results.hasNext()){r=results.next();try{r.pctLtv=Math.round(100*r.balCur/r.estValue)}catch(e){r.pctLtv="";Logger.log("Error : "+e.message)}/*r.lienPos=1;/*LibraryjsUtil.stateConvert(r.state,"abbr");/*.use="X";/*"CRE";/*"MUL";/*r.city=LibraryjsUtil.toCaseTitle(r.city);/*r.item=LibraryjsUtil.toBase62(Number(r.getId().slice(1)));/*if(r.askPrice==""){r.askPrice=0}/* /r.remove=false;r.accepted=false;/*r.askRate=r.buyRate;r.askPrice=r.buyPts;* /r.bids=[];/*r.table="note";r.datePosted=new Date().getTime();* /var i=r.bids.length;while(i--){/*r.bids[i].timestamp=r.bids[i].time;* /r.bids[i].accepted=false;/*r.bids[i].target_id=r.getId();* /r.bids[i].time=""/* /if(r.bids[i].bidder=="atlaslive@gmail.com"){r.bids.splice(i,1)}* /db.save(r);*/arr.push(r);}db.saveBatch(arr,false)}
//function doPost(e){ // function xdoPost(e){return ContentService.createTextOutput("Hello World"/*"User says: "+JSON.stringify(e)*/)} // e.postData.getDataAsString()
//    if(e && e.parameter && e.parameter.k){var k=e.parameter.k,m=e.parameter.m,p=e.parameter;switch(k){
//            case   /* receive from fci */ "36sgd2m257w2j0sn5isa" : return receiveScrape (p,"fciEx"     ) ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
//            case   /* receive from nmp */ "3w34xo2xeuyy8jprgmzg" : return receiveScrape (p,"noteMktPl" ) ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
//            case   /* receive from ml  */ "8u0hjrtbd68s3hi1w9kl" : return receiveScrape (p,"moolahList") ; break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
//         default                                                 :                                       ; break;}}}
//function xdoGet (e){return ContentService.createTextOutput("Hello World")}
function  doGet (e){ // References: https://developers.google.com/apps-script/guides/html-service-communication#private_functions // https://sites.google.com/site/appsscripttutorial/miscellaneous/creating-form-elements-dynamically-using-google-apps-script-gas
 // if(e && e.parameter && e.parameter.jsoncallback){              return ContentService.createTextOutput("                                      foo({result:'<strong>Hello</strong> World'});").setMimeType(ContentService.MimeType./*TEXT*/JAVASCRIPT);} // https://developers.google.com/apps-script/reference/base/mime-type
 // if(e && e.parameter && e.parameter.jsoncallback){              return ContentService.createTextOutput("jQuery164024488894315436482_1409647426359({result:'<strong>Hello</strong> World'});").setMimeType(ContentService.MimeType./*TEXT*/JAVASCRIPT);} // Must inspect http requests and responses
 // if(e && e.parameter && e.parameter.jsoncallback){              return ContentService.createTextOutput(e.parameter.jsoncallback     +           "({result:'<strong>Hello</strong> World'});").setMimeType(ContentService.MimeType./*TEXT*/JAVASCRIPT);}
    if(e && e.parameter && e.parameter.k){var k=e.parameter.k,m=e.parameter.m,p=e.parameter;switch(k){
 //        case   /* serve marquee    */ "rv8eqwuvdm11f66c431g"  : return ContentService.createTextOutput(e.parameter.    callback+"(" + JSON.stringify(serveMarquee       (                 )) + ")").setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
           case   /* serve AVM report */ "3bc9cpv6wb54gyqv6kl3"  : return ContentService.createTextOutput(e.parameter.jsoncallback+"(" + JSON.stringify(avmReportServeData (m.split("?a=")[1])) + ")").setMimeType(ContentService.MimeType./*JSON*/JAVASCRIPT);break; // References // http://www.dimpost.com/2012/12/iframe-how-to-display-specific-part-of.html // http://stackoverflow.com/questions/5676672/how-do-i-crop-the-contents-of-an-iframe-to-show-a-part-of-a-page/14004622#14004622
        default                                                  : break;}}
	if(SitesApp.getActiveSite()){var siteName = SitesApp.getActiveSite().getName();switch(siteName){
            case   "argentabpo"                                  :
                    if(SitesApp.getActivePage()){var pageName = SitesApp.getActivePage().getName();switch(pageName){
                            case   "home"                        : return HtmlService.createHtmlOutputFromFile("home.html"     ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
                            case   "signup"                      : return HtmlService.createHtmlOutputFromFile("signup.html"   ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
                            case   "order"                       : return HtmlService.createHtmlOutputFromFile("order.html"    ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
                            case   "fill"                        : return HtmlService.createHtmlOutputFromFile("fill.html"     ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
                            case   "sandbox"                     : return HtmlService.createHtmlOutputFromFile("sandbox.html"  ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
                            case   "authorize"                   : return authorize                           (                )                                               ;break;
                         default                                 :                                                                                                              break;}}
        //  case   "creditrepairnation"                          : // acquire inventory
		//			if(SitesApp.getActivePage()){var pageName = SitesApp.getActivePage().getName();switch(pageName){
        //                  case   "home"                        : return HtmlService.createHtmlOutputFromFile("collect.html"  ).setSandboxMode(HtmlService.SandboxMode.NATIVE);break;
		//  			 default                                 :                                                                                                             ;break;}}
         default                                                 :                                                                                                              break;}}}
function authorize(){return HtmlService.createHtmlOutput("<div align='center' style='color:#808080;font-family:verdana;color:orange;font-weight:bold;margin-top:15px;'>Authorization successful!<div style='color:#808080;font-size:smaller;font-weight:normal;'>You may now access all features</div><img src='https://lh5.googleusercontent.com/-a81AytXYq0Q/Umtn0FrFdhI/AAAAAAAAIyE/xCYArSNCR1k/s144/orange-check-mark.png' height='100'></div>")}
function receiveSignup(ob){LibraryjsUtil.recordUpdate("argenta","agent",{email:Session.getActiveUser().getEmail()},ob);LibraryjsUtil.zones2zips("argenta","agent","zip",ob)}
function processForm_receiveFundDocs(ob){var i,user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),q={table:"user",seller:true,user:user},r=db.query(q).next();
    if(!r){r=q;r.record=[];r.emailList={current:[],archive:[]};}r.record.unshift(ob);r.record[0].date=t;r.emailList.current.unshift((t+","+ob.emailListString).split(/[\s,]+/)); // function test(){Logger.log("foo bar, zap-foo, baz bat".split(/[\s,]+/))} // Search term: split string by commar or space // Reference: http://stackoverflow.com/questions/1835032/regexp-split-string-by-commas-and-spaces-but-ignore-hyphenated-words
    i=r.emailList.current[0].length;while(i---1){if(r.emailList.archive.indexOf(r.emailList.current[i])==-1){r.emailList.archive.push(r.emailList.current[0][i])}}Logger.log(JSON.stringify(r));db.save(r)}
function processForm_registerSeller(ob){var i,user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),q={table:"user",seller:true,user:user},r=db.query(q).next();
    if(!r){r=q;r.record=[];r.emailList={current:[],archive:[]};}r.record.unshift(ob);r.record[0].timestamp=t;r.emailList.current.unshift((t+","+ob.emailListString).split(/[\s,]+/)); // function test(){Logger.log("foo bar, zap-foo, baz bat".split(/[\s,]+/))} // Search term: split string by commar or space // Reference: http://stackoverflow.com/questions/1835032/regexp-split-string-by-commas-and-spaces-but-ignore-hyphenated-words
    i=r.emailList.current[0].length;while(i---1){if(r.emailList.archive.indexOf(r.emailList.current[i])==-1){r.emailList.archive.push(r.emailList.current[0][i])}}Logger.log(JSON.stringify(r));db.save(r)}
function processForm_addNote(ob){var user=Session.getActiveUser().getEmail(),t=new Date().getTime(),db=ScriptDb.getMyDb(),u=db.query({table:"user",user:user,seller:true}).next(),i,dist=u.emailList.current[0].slice(1),site=SitesApp.getSite("onlinenoteexchange");if(!u.record[0].agreed){Logger.log(user+" did not agree to groundrules.");return}ob.table="note";ob.timestamp_posted=t;ob.seller=user;ob.remove=false;ob.accepted=false;ob.filePic=processPic(ob.filePic);ob.fileDoc=processDoc(ob.fileDoc);if(ob.askPrice==""){ob.askPrice=0};var id=db.save(ob).getId(),r=db.load(id);r.item=LibraryjsUtil.toBase62(Number(id.slice(1)));db.save(r);
    chromeLogoBlob=UrlFetchApp.fetch("https://lh5.googleusercontent.com/-zCLeer1r3ro/Udnn8thtnmI/AAAAAAAAHys/lWkaQnXPv_Q/s144/Google_Chrome_icon_2011.jpg").getBlob().setName("chromeLogoBlob");
    i=dist.length;while(i--){try{site.addViewer(dist[i])}catch(e){Logger.log(dist[i]+": "+e.message)}MailApp.sendEmail({to:dist[i],subject:"New loan: "+r.askRate+"%, "+r.askPrice+" points",htmlBody:("<a href='https://sites.google.com/site/onlinenoteexchange/buy'>Click here</a> (item: "+r.item+") <a href='https://www.google.com/intl/en/chrome/browser/'><img src='cid:chromeLogo' height='15' style='text-decoration:none;border:0;outline:none'></a> <a href='https://www.google.com/intl/en/chrome/browser/'>Chrome required</a>.<br><br>Rate: "+r.askRate+"% +"+r.askPrice+" points<br><br>Collateral:<br>"+r.sa+", "+r.city+", "+r.state+" "+r.zip+"<br>"+r.use+", "+r.beds+" beds, "+r.baths+" baths, "+r.sqft+" sqft, "+"<br><br>Loan Type: "+r.purpose+"<br>Unpaid Principal Balance: $"+r.balCur+"<br>Estimated Value: $"+r.estValue+"<br>LTV: "+r.pctLtv/*+"%<br>Term: "+r.term+" months<br>"*/+"<br>Highlights: "+r.notes),name:"atlaslive@gmail.com",inlineImages:{chromeLogo:chromeLogoBlob/*,youtubeLogo:youtubeLogoBlob*/}});}/*Logger.log(JSON.stringify(ob));*/return}
function sendUserToClient(){var user=Session.getActiveUser().getEmail(),u=ScriptDb.getMyDb().query({table:"user",seller:true,user:user}).next();/*Logger.log(JSON.stringify(r));*/return u;}
function processDoc(blob){try{var id=DocsList.createFile(blob/*.getAs("application/pdf")*/).getId();}catch(e){Logger.log("Error : "+e.message);return "";}DriveApp.getFileById(id).setSharing(DriveApp.Access.ANYONE_WITH_LINK,DriveApp.Permission.VIEW);return DocsList.getFileById(id).getUrl();} // Reference: https://developers.google.com/apps-script/reference/base/composite-blob#getAs(String) // Reference: https://code.google.com/p/google-apps-script-issues/issues/detail?id=1660 see #37, Oct 13, 2012 // Use DocsList instead of DriveApp which will not allow document to be viewed properly
function processPic(blob){if(!blob.length){return ""}return "https://drive.google.com/uc?export=view&id="+DriveApp.createFile(blob/*.getAs("image/jpeg")*/).setSharing(DriveApp.Access.ANYONE_WITH_LINK,DriveApp.Permission.VIEW).getId()} // Image // Reference: http://stackoverflow.com/questions/10311092/displaying-files-e-g-images-stored-in-google-drive-on-a-website // http://stackoverflow.com/questions/14717426/referencing-project-files-with-html-service > http://googleappsdeveloper.blogspot.in/2012/11/announcing-google-drive-site-publishing.html
//function avmReportGetLink(ob){return "<a href='https://googledrive.com/host/0B1LVOoV_2dFtNUZuRTZ6T0pPT00?a="+encodeURIComponent(LibraryjsAvm.avmPrep(ob.address,"manual").address.full)+"'><img src='https://lh4.googleusercontent.com/-WFV1IdXKZvI/U_1KktTMNOI/AAAAAAAAMmM/Ky7L7IOq0Lc/s144/btn.png'></a>"}//JSON.stringify(LibraryjsAvm.avmData(addy))}//addy}//"<strong>Hello</strong> world"}//return HtmlService.createHtmlOutputFromFile("AvmReport.html").setSandboxMode(HtmlService.SandboxMode.NATIVE)}//function test(){var out=JSON.stringify(avmReportGetLink("5115 Longfellow Street, Los Angeles, CA, 90042"));Logger.log(out);print(out)}//"5115 Longfellow Street, Los Angeles, CA, 90042"//"12204 12th Ave NW, Seattle, WA 98177"
function avmReportServeData_batch(id){//@param{string} id — Google Sheets spreadsheet ID (Date is in column 1 ONLY; col 1 will have header, so addresses will start on row 2)
    var sheet=SpreadsheetApp.openById(id).getSheets()[0],i=1,returnCellCount=3,range,addy,out,empty,lena,lene;
    sheet.getRange(1,2,1,returnCellCount).setValues([["Estimate","Low","High"]]).setHorizontalAlignment("center");
    sheet.getRange(1,1,sheet.getLastRow(),1).setHorizontalAlignment("left")
    sheet.getRange(1,2,sheet.getLastRow(),returnCellCount).setNumberFormat("$#,##0_);($#,##0)").setHorizontalAlignment("right");
    while(true){
        range=sheet.getRange(++i,1,1,returnCellCount+1);
        addy =range.getCell(1,1).getValue();
        empty=range.getCell(1,2).getValue();
        lena =addy .length||addy;
        lene =empty.length||empty;
        if(lena&&lene){continue}else if(lena&&!lene){
            try{out=avmReportServeData(addy).dataTable[1];out.shift()}catch(e){out=["X","X","X"];Logger.log("Error Jh2sR: %s",e.message)} // ob.dataTable[1]=["Median",est,low,high]
		 // out.push(); // Add additional additional data fields in the future here. Also adjust returnCellCount and setValues([["Estimate","Low","High"]]) accordingly
            sheet.getRange(i,2,1,returnCellCount).setValues([out]);Utilities.sleep(5000)
        }else{break}}return} // function test(){Logger.log(avmReportServeData_batch("1YH5s11C2K3QUEOeVuBeEv7zCoHDRX7NfFh5dHfB9Tz8"))}
function avmReportServeData(addy){//addy=addy||"3255 Whitehall Dr, Dallas, TX 75229";//function test(){var out=JSON.stringify(avmReportServeData("5115 Longfellow Street, Los Angeles, CA, 90042"));Logger.log(out);print(out)}//Logger.log(addy);//print(JSON.stringify(LibraryjsAvm.avmJson({"source":{"name":"manual","data":addy}/*,"market":{"city":"Pheonix","state":"AZ"}*/})));
      var R=0.5,S=1,out={},r=LibraryjsAvm.avmJson({"source":{"name":"manual","data":decodeURI(addy).replace(/(\+|\-)/gi," ")}/*,"market":{"city":"Pheonix","state":"AZ"}*/})
	  , nn = r.avm.dataset.zillow.searchresults.response.results.result.localRealEstate.region.name,n=[LibraryjsAvm.nhoodZillow_fetch(r.address.state,r.address.city,nn),LibraryjsAvm.nhoodZillow_api(r.address.state,r.address.city,nn)]
	  // print(JSON.stringify({r:r,n:n})); // Data model : {"r":{"avm":{"dataset":{"zillow":{"searchresults":{"request":{"citystatezip":{"Text":"90042"},"address":{"Text":"5116 Longfellow St"}},"schemalocation":"http://www.zillow.com/static/xsd/SearchResults.xsd http://www.zillowstatic.com/vstatic/6eb1265/static/xsd/SearchResults.xsd","response":{"results":{"result":{"lastSoldDate":{"Text":"06/24/1992"},"yearBuilt":{"Text":"1925"},"bathrooms":{"Text":"3.0"},"localRealEstate":{"region":{"type":"neighborhood","zindexValue":{"Text":"545,000"},"id":"115609","name":"Highland Park","links":{"forSaleByOwner":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/fsbo/"},"forSale":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/"},"overview":{"Text":"http://www.zillow.com/local-info/CA-Los-Angeles/Highland-Park/r_115609/"}}}},"bedrooms":{"Text":"5"},"finishedSqFt":{"Text":"1854"},"taxAssessment":{"Text":"302285.0"},"lotSizeSqFt":{"Text":"4900"},"useCode":{"Text":"SingleFamily"},"taxAssessmentYear":{"Text":"2013"},"lastSoldPrice":{"currency":"USD","Text":"159000"},"FIPScounty":{"Text":"6037"},"zpid":{"Text":"20761923"},"zestimate":{"percentile":{"Text":"0"},"amount":{"currency":"USD","Text":"749086"},"oneWeekChange":{"deprecated":"true"},"valueChange":{"currency":"USD","Text":"46266","duration":"30"},"valuationRange":{"low":{"currency":"USD","Text":"704141"},"high":{"currency":"USD","Text":"801522"}},"last_updated":{"Text":"09/18/2014"}},"rentzestimate":{"amount":{"currency":"USD","Text":"2659"},"oneWeekChange":{"deprecated":"true"},"valueChange":{"currency":"USD","Text":"6","duration":"30"},"valuationRange":{"low":{"currency":"USD","Text":"1994"},"high":{"currency":"USD","Text":"3430"}},"last_updated":{"Text":"07/07/2014"}},"links":{"comparables":{"Text":"http://www.zillow.com/homes/comps/20761923_zpid/"},"homedetails":{"Text":"http://www.zillow.com/homedetails/5116-Longfellow-St-Los-Angeles-CA-90042/20761923_zpid/"},"mapthishome":{"Text":"http://www.zillow.com/homes/20761923_zpid/"},"graphsanddata":{"Text":"http://www.zillow.com/homedetails/5116-Longfellow-St-Los-Angeles-CA-90042/20761923_zpid/#charts-and-data"}},"totalRooms":{"Text":"8"},"address":{"street":{"Text":"5116 Longfellow St"},"city":{"Text":"Los Angeles"},"longitude":{"Text":"-118.197347"},"latitude":{"Text":"34.103437"},"state":{"Text":"CA"},"zipcode":{"Text":"90042"}}}}},"message":{"text":{"Text":"Request successfully processed"},"code":{"Text":"0"}},"xsi":"urn:x-prefix:xsi"},"estimate":"749086","link":"http://www.zillow.com/webservice/GetDeepSearchResults.htm?rentzestimate=true&zws-id=X1-ZWz1czg9fsh6vf_26nu3&address=5116+Longfellow+St&citystatezip=90042"},"trulia":{"beds":"5","baths":"3","sqft":"1854","lot":"n/a","yrBuilt":"1925","estimate":"615000","dataSet":"{\"id\":4030273,\"feedId\":null,\"hash\":\"2a6ddb90396b6d482bb3e377f182eaec\",\"neighborhood\":\"Eagle Rock\",\"neighborhoodId\":7225,\"zipCode\":\"90042\",\"city\":\"Los Angeles\",\"county\":\"Los Angeles\",\"countyFIPS\":\"06037\",\"stateCode\":\"CA\",\"stateName\":\"California\",\"latitude\":34.103436,\"longitude\":-118.19735,\"addressForDisplay\":\"5116 Longfellow Street, Los Angeles CA\",\"addressForUrl\":\"5116-Longfellow-St-Los-Angeles-CA-90042\",\"streetNumber\":\"5116\",\"street\":\"Longfellow St\",\"apartmentNumber\":null,\"urlType\":null,\"status\":\"Assessor\",\"listingId\":null,\"locationId\":\"76108\",\"type\":\"SINGLE-FAMILY HOME\",\"typeDisplay\":\"Single-Family Home\",\"numBedrooms\":5,\"numBathrooms\":3,\"numPartialBathrooms\":null,\"numFullBathrooms\":3,\"siteId\":null,\"siteUrl\":null,\"listingType\":null,\"dmaId\":31,\"claimed\":null,\"numBeds\":5,\"indexSource\":\"Assessor\",\"isForeclosure\":false,\"foreclosureStatus\":\"\",\"isSrpFeatured\":false,\"price\":null,\"sqft\":1854,\"isRental\":false,\"isRentalCommunity\":false,\"hasStreetView\":\"-1\",\"showStreetView\":\"1\",\"blockStreetView\":false,\"walkScore\":null,\"photos\":null,\"adCampaign\":null,\"hasPhotos\":false,\"userHidden\":null,\"userLiked\":null,\"isAddressNotDisclosed\":false,\"_isDefault\":true,\"intersectionName\":null,\"agentClaimable\":true,\"pdpURL\":\"\\/homes\\/California\\/Los_Angeles\\/sold\\/4030273-5116-Longfellow-St-Los-Angeles-CA-90042\",\"thumbnail\":null,\"formattedPrice\":\"\",\"shortDescription\":\"5116 Longfellow St\",\"formattedBedAndBath\":\"5bd, 3 full ba\",\"formattedSqft\":\"1,854 sqft\",\"dataPhotos\":\"{\\\"photos\\\":[],\\\"static_map_path\\\":\\\"http:\\\\\\/\\\\\\/maps.googleapis.com\\\\\\/maps\\\\\\/api\\\\\\/staticmap?client=gme-truliainc&zoom=18&size=640x480&maptype=satellite&sensor=false&center=34.103436%2C-118.19735&signature=VqfEHISt49VrreIMlcMIitieXk0=\\\"}\",\"isBuilder\":null,\"isBuilderCommunity\":false,\"isPlan\":false,\"isSpec\":false,\"userClaimed\":false});\n  pdp_location_data = {\"neighborhood\":{\"locationId\":\"87346\",\"name\":\"Eagle Rock\",\"locationType\":\"neighborhood\",\"altId\":\"7225\"},\"state\":{\"locationId\":\"5\",\"name\":\"California\",\"locationType\":\"state\",\"altId\":\"CA\"},\"county\":{\"locationId\":\"57\",\"name\":\"Los Angeles County\",\"locationType\":\"county\",\"altId\":\"06037\"},\"city\":{\"locationId\":\"22637\",\"name\":\"Los Angeles\",\"locationType\":\"city\",\"altId\":\"4396\"},\"propertyId\":4030273,\"addressHash\":null,\"address\":\"5116 Longfellow St\",\"zipCode\":{\"locationId\":\"76108\",\"name\":\"90042\",\"locationType\":\"zipCode\",\"altName\":\"90042\",\"altId\":\"90042\"},\"geohash\":\"9q5fn276fj5z\",\"latitude\":34.103436,\"longitude\":-118.19735,\"unknown\":true,\"isCountySupportsValuation\":false};\n  trulia.pdp.comps_markers = {\"for sale\":[],\"sold\":[]};\n  trulia.pdp.streetViewBlocked = false;\n  trulia.pdp.isCountySupportsValuation = pdp_location_data.isCountySupportsValuation;\n\n  var _RENTALS_PARTNER_NAME = \"\";\n  var _SPANLONG = pdp_location_data.longitude;\n  var _SPANLAT  = pdp_location_data.latitude;\n  var _CENLONG  = pdp_location_data.longitude;\n  var _CENLAT   = pdp_location_data.latitude;\n  var _LOCATION_UNKNOWN = pdp_location_data.unknown;\n\n  // global vars, may be used on all tabs\n  var _IMAGE_SERVER = 'http://static.trulia-cdn.com';\n  var _JS_SERVER_ROOT = 'http://static.trulia-cdn.com/javascript/G33_34/';\n  var _MAPTILE_SERVER = 'http://tiles.trulia.com/';\n  var _HEATMAP_VERSIONS = {\"domain\":\"http:\\/\\/tiles.trulia.com\",\"singles_living_alone\":{\"uri\":\"tiles\\/singles_living_alone\",\"version\":\"20140709\"},\"wildfires\":{\"uri\":\"tiles\\/wildfires\",\"version\":\"20130910\"},\"shopping\":{\"uri\":\"tiles\\/shopping\",\"version\":\"20140809\"},\"tornados\":{\"uri\":\"tiles\\/tornados\",\"version\":\"20140530\"},\"valuations\":{\"uri\":\"tiles\\/valuations\",\"version\":\"20140214\"},\"beauty\":{\"uri\":\"tiles\\/beauty\",\"version\":\"20140809\"},\"percent_married\":{\"uri\":\"tiles\\/percent_married\",\"version\":\"20140709\"},\"crime_heatmap\":{\"uri\":\"tiles\\/crime_heatmap\",\"version\":\"20140114\"},\"median_age\":{\"uri\":\"tiles\\/median_age\",\"version\":\"20140709\"},\"rental_prices\":{\"uri\":\"tiles\\/rental_prices\",\"version\":\"20140828\"},\"groceries\":{\"uri\":\"tiles\\/groceries\",\"version\":\"20140809\"},\"hurricanes\":{\"uri\":\"tiles\\/hurricanes\",\"version\":\"20140530\"},\"percent_multiunit\":{\"uri\":\"tiles\\/percent_multiunit\",\"version\":\"20140709\"},\"schools\":{\"uri\":\"tiles\\/schools\",\"version\":\"20130910\"},\"seismic_hazard\":{\"uri\":\"tiles\\/seismic_hazard\",\"version\":\"20130910\"},\"gyms\":{\"uri\":\"tiles\\/gyms\",\"version\":\"20140809\"},\"arts\":{\"uri\":\"tiles\\/arts\",\"version\":\"20140809\"},\"median_move_in_year\":{\"uri\":\"tiles\\/median_move_in_year\",\"version\":\"20140709\"},\"year_built\":{\"uri\":\"tiles\\/year_built\",\"version\":\"20140709\"},\"home_prices_sales_sqft\":{\"uri\":\"tiles\\/home_prices_sales_sqft\",\"version\":\"20131231\"},\"percent_college\":{\"uri\":\"tiles\\/percent_college\",\"version\":\"20140709\"},\"cafes\":{\"uri\":\"tiles\\/cafes\",\"version\":\"20140809\"},\"commute_time\":{\"uri\":\"tiles\\/commute_time\",\"version\":\"20140709\"},\"owner_occupied\":{\"uri\":\"tiles\\/owner_occupied\",\"version\":\"20140709\"},\"home_prices_sales\":{\"uri\":\"tiles\\/home_prices_sales\",\"version\":\"20131231\"},\"faults\":{\"uri\":\"tiles\\/faults\",\"version\":\"20130910\"},\"nightlife\":{\"uri\":\"tiles\\/nightlife\",\"version\":\"20140809\"},\"transit\":{\"uri\":\"tiles\\/transit\",\"version\":\"20140709\"},\"flood_zones\":{\"uri\":\"tiles\\/flood_zones\",\"version\":\"20130910_02\"},\"parcels\":{\"uri\":\"tiles\\/parcels\",\"version\":\"20140218\"},\"home_prices_listings\":{\"uri\":\"tiles\\/home_prices_listings\",\"version\":\"20140116\"},\"restaurants\":{\"uri\":\"tiles\\/restaurants\",\"version\":\"20140809\"},\"rental_prices_nolabel\":{\"uri\":\"tiles\\/rental_prices_nolabel\",\"version\":\"20140828\"}};\n\n  var _SHOW_PARCEL_BOUNDARIES = 1;\n\n  // compare tab\n  var thumbs_root = '';\n\n  // schools tab\n  var _default_zoom_level = '15';\n  var _default_map_view = 'G_MAP_TYPE';\n  var _show_poi = '0';\n\n  var direction = 0;\n  var z_details_pg = 1;\n\n  //used by the maps to determine if we can show street view and the address\n  // AI: will be refactored\n  var showStreetview = true;\n  var showAddressControl = true;\n\n  \n    var showMarvinGardensTest = false;\n  \n  _feature_pdp_photo_player_ad_enabled = true;\n</script>\n\n<script src=\"//maps.google.com/maps/api/js?v=3.17&client=gme-truliainc&sensor=false&libraries=geometry\"></script>\n<script src=\"http://static.trulia-cdn.com/javascript/G33_34/include/js/pdp.js?v=G33_34\"></script>\n<script src=\"http://static.trulia-cdn.com/javascript/G33_34/include/js/maps_v3.js?v=G33_34\" defer></script>\n\n  \n<script type=\"text/template\" id=\"popupModuleTemplate\">\n  <div class=\"modal box boxBasic backgroundBasic pbs\" style=\"position:absolute\" data-title=\"5116 Longfellow St\">\n    <div class=\"boxHead boxHeadBasic pas\"><h3 id=\"glanceModalTitle\"></h3></div>\n    <div class=\"boxBody pbl\">\n      <button class=\"boxClose\"><span role=\"presentation\">&times;</span><span class=\"hideVisually\">Close</span></button>\n      <div id=\"glanceMapDetailInfoContainer\" class=\"places_detail_info_container overlayFullWidth\">\n        <div id=\"glanceMapDetailInfo\" class=\"places_detail_info box boxBasic man h7\"></div>\n      </div>\n      <div id=\"glanceMap\" style=\"height:300px;width:625px\"></div>\n      <div id=\"glanceMapAttribution\" class=\"h8 typeLowlight line\"></div>\n      <div id=\"glanceInfoWindow\" class=\"places_ui_labels map-infoWindow\"></div>\n      <div id=\"glanceHoverWindow\" class=\"places_ui_labels map-infoWindow\"></div>\n      <div id=\"glanceModalTable\"></div>\n    </div>\n  </div>\n</script>\n\n<script type=\"text/template\" id=\"photoPlayerInterstitialTemplate\">\n  <div id=\"<%= divId %>\">\n    <div class=\"h7 interstitialThumbnail blm\">\n      <div class=\"line\">\n        <div class=\"col cols8\">\n          <img class=\"interstitialThumbnailImg\" src=\"<%= agentPicture %>\">\n        </div>\n        <div class=\"col lastCol plm\">\n          <span class=\"typeEmphasize\">\n              <% if (agentName.length > 15)\n                 {\n                    print(agentName.substring(0,12) + '...');\n                 }\n                 else\n                 {\n                    print(agentName);\n                 }\n              %>\n          </span><br>\n          <% print(numPhotos + (numPhotos == 1? ' photo' : ' photos')","locationData":false,"comps":false,"link":"http://www.trulia.com/homes/California/Los_Angeles/sold/4030273-5116-Longfellow-St-Los-Angeles-CA-90042"},"homeSnap":{"low":"456280","estimate":"536800","high":"617320","foo":"div","beds":"5","heating":"Floor / Wall","pmtEst":"--","bathsFull":"3","basement":false,"rentEst":"2430","bathsHalf":"--","stories":false,"taxEst":"3778","sqft":"1854","addressStories":false,"homeScore":"71","lot":"0.11","fireplaces":false,"investorScore":"52","lastSaleDate":"--","lastSalePrice":"--","yearBuilt":"1925","link":"http://www.homesnap.com/CA/Los-Angeles/5116-Longfellow-Street"},"realtor":{"status":"Not For Sale","beds":"5","baths":"3","sqft":"1854","lot":"4900 Sq Ft Lot","built":"1925","smartZip_est":"463100","smartZip_low":"393635","smartZip_high":"532565","dataQuick_est":"549758","dataQuick_low":"419392","dataQuick_high":"680123","eppraisal_est":"480392","eppraisal_low":"408333","eppraisal_high":"552451","link":"http://www.realtor.com/propertyrecord-search/Los-Angeles_CA/90042/5116-Longfellow-St"},"dataQuick":{"estimate":"549758","high":"680123","low":"419392"},"smartZip":{"estimate":"463100","high":"532565","low":"393635"},"eppraisal":{"estimate":"480392","high":"552451","low":"408333"},"realEstate":{"estimate":"361172","beds":"5","baths":"3","sqft":"1854","built":"1925","stories":"1","lot":"0.11","link":"http://www.realestate.com/homevalues/5116-Longfellow-St,Los-Angeles,CA/"}},"combi":{"useCode":"SFR","beds":"5","baths":"3.0","sqft":"1854","lot":"4900","built":"1925","taxVal":"302285.0","lastSoldPrice":"159000","lastSoldDate":"06/24/1992","lastSoldYear":"1992"},"stat":{"ob":{"realEstate":"361172","eppraisal":"480392","smartZip":"463100","dataQuick":"549758","homeSnap":"536800","trulia":"615000","zillow":"749086"},"set":["749086","615000","549758","536800","480392","463100","361172"],"isOk":true,"popCount":7,"autoEst":536800,"margin":null,"ratio":null,"sdPop":113897,"sdPct":22}},"address":{"sa":"5116 Longfellow St","city":"Los Angeles","state":"CA","zip":"90042","csz":"Los Angeles, CA 90042","full":"5116 Longfellow St, Los Angeles, CA 90042","part":"Longfellow St, Los Angeles, CA 90042","number":"5116"},"isRaw":false,"table":"situs","source":{"name":"manual","data":"5115 Longfellow Street, Los Angeles, CA, 90042"},"link":{"gmap":"https://maps.google.com/maps?q=5116+Longfellow+St,+Los+Angeles,+CA+90042","zillow":"http://www.zillow.com/homes/5116-Longfellow-St,-90042_rb/","propertyShark":"http://www.propertyshark.com/","neighborhoodScout":"http://www.neighborhoodscout.com/","zipSkinny":"http://zipskinny.com/index.php?zip=90042","chase":"https://www.chase.com/mortgage/mortgage-resources/home-value-estimator","boa":"http://realestatecenter.bankofamerica.com/tools/marketvalue.aspx","homesCom":"http://www.homes.com/Home-Prices/","homeSnap":"http://www.homesnap.com/CA/Los-Angeles/5116-Longfellow-Street","trulia":"http://www.trulia.com/homes/California/Los_Angeles/sold/4030273-5116-Longfellow-St-Los-Angeles-CA-90042","realEstate":"http://www.realestate.com/homevalues/5116-Longfellow-St,Los-Angeles,CA/","realtor":"http://www.realtor.com/propertyrecord-search/Los-Angeles_CA/90042/5116-Longfellow-St","photo":false},"offer":{"beforeRepairs":{"auto":null,"manual":{}},"afterRepairs":{"manual":{}}},"incomeApproach":null,"arv":{},"repairs":{},"counter":{},"analysis":{},"contract":{},"assignment":{}},"n":[{"regId":"115609","regName":"Highland Park","regType":"8","regMbr":"-118.20815534.102023-118.16558634.133961","parId":"12447","parName":"Los Angeles","parType":"6","natId":"102001","natName":"United States","indexSubject":"545000","foo":"class=\"entries\">","mktHealth":"9.2","fcVal0":"2.2","fcLab0":"Highland Park","fcVal1":"2.2","fcLab1":"Los Angeles","fcVal2":"4.3","fcLab2":"United States","nb1link":"/south-arroyo-pasadena-ca/home-values/","nb1name":"South Arroyo","nb1price":"1005700","nb2link":"/glenoake-canyon-glendale-ca/home-values/","nb2name":"Glenoake Canyon","nb2price":"809000","nb3link":"/eagle-rock-los-angeles-ca/home-values/","nb3name":"Eagle Rock","nb3price":"670300","nb4link":"/mount-washington-los-angeles-ca/home-values/","nb4name":"Mount Washington","nb4price":"652000","nb5link":"/glassell-park-los-angeles-ca/home-values/","nb5name":"Glassell Park","nb5price":"590800","nb6link":"/hermon-los-angeles-ca/home-values/","nb6name":"Hermon","nb6price":"499300","nb7link":"/cypress-park-los-angeles-ca/home-values/","nb7name":"Cypress Park","nb7price":"489900","nb8link":"/montecito-heights-los-angeles-ca/home-values/","nb8name":"Montecito Heights","nb8price":"427900","nb9link":"/el-sereno-los-angeles-ca/home-values/","nb9name":"El Sereno","nb9price":"383400","link":"http://www.zillow.com/Highland-Park-Los-Angeles-CA/home-values/"},{"demographics":{"request":{"city":{"Text":"Los Angeles"},"neighborhood":{"Text":"Highland Park"},"state":{"Text":"CA"}},"schemalocation":"http://www.zillow.com/static/xsd/Demographics.xsd http://www.zillowstatic.com/vstatic/6eb1265/static/xsd/Demographics.xsd","response":{"market":{"deprecated":"true"},"region":{"zmmrateurl":{"Text":"http://www.zillow.com/mortgage-rates/ca/los-angeles/"},"city":{"Text":"Los Angeles"},"longitude":{"Text":"-118.18687"},"neighborhood":{"Text":"Highland Park"},"latitude":{"Text":"34.117992"},"state":{"Text":"California"},"id":{"Text":"115609"}},"pages":{"page":[{"name":{"Text":"Affordability"},"tables":{"table":{"data":{"attribute":[{"values":{"city":{"value":{"type":"USD","Text":"525200"}},"neighborhood":{"value":{"type":"USD","Text":"545000"}},"nation":{"value":{"type":"USD","Text":"175600"}}},"name":{"Text":"Zillow Home Value Index"}},{"values":{"city":{"value":{"type":"USD","Text":"561800"}},"neighborhood":{"value":{"type":"USD","Text":"553200"}},"nation":{"value":{"type":"USD","Text":"175300"}}},"name":{"Text":"Median Single Family Home Value"}},{"values":{"city":{"value":{"type":"USD","Text":"427200"}},"nation":{"value":{"type":"USD","Text":"178400"}}},"name":{"Text":"Median Condo Value"}},{"values":{"city":{"value":{"type":"USD","Text":"451500"}},"neighborhood":{"value":{"type":"USD","Text":"503300"}},"nation":{"value":{"type":"USD","Text":"135100"}}},"name":{"Text":"Median 2-Bedroom Home Value"}},{"values":{"city":{"value":{"type":"USD","Text":"505600"}},"neighborhood":{"value":{"type":"USD","Text":"599700"}},"nation":{"value":{"type":"USD","Text":"169300"}}},"name":{"Text":"Median 3-Bedroom Home Value"}},{"values":{"city":{"value":{"type":"USD","Text":"670900"}},"neighborhood":{"value":{"type":"USD","Text":"670800"}},"nation":{"value":{"type":"USD","Text":"284300"}}},"name":{"Text":"Median 4-Bedroom Home Value"}},{"values":{"city":{"value":{"type":"percent","Text":"0.12"}},"neighborhood":{"value":{"type":"percent","Text":"0.14"}},"nation":{"value":{"type":"percent","Text":"0.276"}}},"name":{"Text":"Percent Homes Decreasing"}},{"values":{"city":{"value":{"type":"percent","Text":"0.333"}},"neighborhood":{"value":{"type":"percent","Text":"0.27"}},"nation":{"value":{"type":"percent","Text":"0.367"}}},"name":{"Text":"Percent Listing Price Reduction"}},{"values":{"city":{"value":{"type":"USD","Text":"360"}},"neighborhood":{"value":{"type":"USD","Text":"468"}},"nation":{"value":{"type":"USD","Text":"112"}}},"name":{"Text":"Median List Price Per Sq Ft"}},{"values":{"city":{"value":{"type":"USD","Text":"580000"}},"neighborhood":{"value":{"type":"USD","Text":"500000"}},"nation":{"value":{"type":"USD","Text":"215000"}}},"name":{"Text":"Median List Price"}},{"values":{"city":{"value":{"type":"USD","Text":"540400"}},"neighborhood":{"value":{"type":"USD","Text":"514800"}},"nation":{"value":{"type":"USD","Text":"215500"}}},"name":{"Text":"Median Sale Price"}},{"values":{"city":{"value":{"Text":"0"}},"neighborhood":{"value":{"Text":"0"}},"nation":{"value":{"Text":"0"}}},"name":{"Text":"Homes For Sale"}},{"values":{"city":{"value":{"Text":"0"}},"neighborhood":{"value":{"Text":"0"}},"nation":{"value":{"Text":"0"}}},"name":{"Text":"Homes Recently Sold"}},{"values":{"city":{"value":{"type":"USD","Text":"3422"}},"neighborhood":{"value":{"type":"USD","Text":"2581"}},"nation":{"value":{"type":"USD","Text":"2081"}}},"name":{"Text":"Property Tax"}},{"values":{"city":{"value":{"type":"percent","Text":"0.045"}},"neighborhood":{"value":{"type":"percent","Text":"0.042"}},"nation":{"value":{"type":"percent","Text":"0.04"}}},"name":{"Text":"Turnover (Sold Within Last Yr.)"}},{"values":{"city":{"value":{"type":"USD","Text":"371"}},"neighborhood":{"value":{"type":"USD","Text":"395"}},"nation":{"value":{"type":"USD","Text":"120"}}},"name":{"Text":"Median Value Per Sq Ft"}},{"values":{"city":{"value":{"type":"percent","Text":"0.111"}},"neighborhood":{"value":{"type":"percent","Text":"0.107"}},"nation":{"value":{"type":"percent","Text":"0.066"}}},"name":{"Text":"1-Yr. Change"}},{"values":{"city":{"value":{}},"neighborhood":{"value":{}},"nation":{"value":{}}},"name":{"Text":"Homes For Sale By Owner"}},{"values":{"city":{"value":{}},"neighborhood":{"value":{}},"nation":{"value":{}}},"name":{"Text":"New Construction"}},{"values":{"city":{"value":{}},"neighborhood":{"value":{}},"nation":{"value":{}}},"name":{"Text":"Foreclosures"}}]},"name":{"Text":"Affordability Data"}}}},{"name":{"Text":"Homes & Real Estate"},"tables":{"table":[{"data":{"attribute":[{"values":{"city":{"value":{"type":"percent","Text":"0.38564544"}},"neighborhood":{"value":{"type":"percent","Text":"0.34724894"}},"nation":{"value":{"type":"percent","Text":"0.66268764"}}},"name":{"Text":"Owners"}},{"values":{"city":{"value":{"type":"percent","Text":"0.61435456"}},"neighborhood":{"value":{"type":"percent","Text":"0.65275106"}},"nation":{"value":{"type":"percent","Text":"0.33731236"}}},"name":{"Text":"Renters"}},{"values":{"city":{"value":{"Text":"1586"}},"neighborhood":{"value":{"Text":"1296"}}},"name":{"Text":"Median Home Size (Sq. Ft.)"}},{"values":{"city":{"value":{"Text":"1952"}},"neighborhood":{"value":{"Text":"1923"}}},"name":{"Text":"Avg. Year Built"}},{"values":{"city":{"value":{"type":"percent","Text":"0.6296068291882"}},"neighborhood":{"value":{"type":"percent","Text":"0.6764875794338"}}},"name":{"Text":"Single-Family Homes"}},{"values":{"city":{"value":{"type":"percent","Text":"0.1751662152179"}},"neighborhood":{"value":{"type":"percent","Text":"0.0399768919699"}}},"name":{"Text":"Condos"}}]},"name":{"Text":"Homes & Real Estate Data"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.0142418661755"},"name":{"Text":"<1900"}},{"value":{"type":"percent","Text":"0.0114180478821"},"name":{"Text":">2000"}},{"value":{"type":"percent","Text":"0.2570902394106"},"name":{"Text":"1900-1919"}},{"value":{"type":"percent","Text":"0.424554941682"},"name":{"Text":"1920-1939"}},{"value":{"type":"percent","Text":"0.1170042971147"},"name":{"Text":"1940-1959"}},{"value":{"type":"percent","Text":"0.1263351749539"},"name":{"Text":"1960-1979"}},{"value":{"type":"percent","Text":"0.0493554327808"},"name":{"Text":"1980-1999"}}]},"name":{"Text":"BuiltYear"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.2721222578259"},"name":{"Text":"<1000sqft"}},{"value":{"type":"percent","Text":"0.0454769534138"},"name":{"Text":">3600sqft"}},{"value":{"type":"percent","Text":"0.2959083066305"},"name":{"Text":"1000-1400sqft"}},{"value":{"type":"percent","Text":"0.1727877742174"},"name":{"Text":"1400-1800sqft"}},{"value":{"type":"percent","Text":"0.1249691890559"},"name":{"Text":"1800-2400sqft"}},{"value":{"type":"percent","Text":"0.0743159970421"},"name":{"Text":"2400-3600sqft"}}]},"name":{"Text":"Census Summary-HomeSize"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.0399768919699"},"name":{"Text":"Condo"}},{"value":{"type":"percent","Text":"0.2835355285961"},"name":{"Text":"Other"}},{"value":{"type":"percent","Text":"0.6764875794338"},"name":{"Text":"SingleFamily"}}]},"name":{"Text":"Census Summary-HomeType"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.34724894"},"name":{"Text":"Own"}},{"value":{"type":"percent","Text":"0.65275106"},"name":{"Text":"Rent"}}]},"name":{"Text":"Census Summary-Occupancy"}}]}},{"segmentation":{"liveshere":[{"description":{"Text":"Born outside the U.S., they have moved to the U.S. and live in the city. Wide age range. Some have a high school or college education, and they work in a variety of occupations."},"title":{"Text":"Foreign-born Urbanites"},"name":{"Text":"Foreign-born individuals who live in city."}},{"description":{"Text":"Mixed educational status with some having a high school education and some college. Combined income low-to-moderate."},"title":{"Text":"Stretched Budgets"},"name":{"Text":"Lower-scale urban couples with children."}},{"description":{"Text":"Pre-middle-age to middle-age singles with upper-scale incomes. May or may not own their own home. Most have college educations and are employed in mid-management professions."},"title":{"Text":"Makin' It Singles"},"name":{"Text":"Upper-scale urban singles."}}]},"uniqueness":{"category":[{"type":"Education","characteristic":{"Text":"Did not complete high school"}},{"type":"Employment","characteristic":[{"Text":"Work in construction and extraction occupations"},{"Text":"Work in personal care and service occupations"},{"Text":"Work in production occupations"}]},{"type":"People & Culture","characteristic":[{"Text":"Not U.S. citizens"},{"Text":"Separated females"},{"Text":"Single females"},{"Text":"Single males"},{"Text":"Speak Spanish or Spanish Creole"}]},{"type":"Transportation","characteristic":[{"Text":"Carpool to work"},{"Text":"Get to work by bus"}]}]},"name":{"Text":"People"},"tables":{"table":[{"data":{"attribute":[{"values":{"city":{"value":{"currency":"USD","Text":"36687"}},"neighborhood":{"value":{"currency":"USD","Text":"34791.3972980957"}},"nation":{"value":{"currency":"USD","Text":"44512.0130806292"}}},"name":{"Text":"Median Household Income"}},{"values":{"city":{"value":{"type":"percent","Text":"0.202873449846198"}},"neighborhood":{"value":{"type":"percent","Text":"0.201457805106603"}},"nation":{"value":{"type":"percent","Text":"0.146462187349365"}}},"name":{"Text":"Single Males"}},{"values":{"city":{"value":{"type":"percent","Text":"0.168171518410535"}},"neighborhood":{"value":{"type":"percent","Text":"0.175584818056711"}},"nation":{"value":{"type":"percent","Text":"0.124578258618535"}}},"name":{"Text":"Single Females"}},{"values":{"city":{"value":{"Text":"33"}},"neighborhood":{"value":{"Text":"31"}},"nation":{"value":{"Text":"36"}}},"name":{"Text":"Median Age"}},{"values":{"city":{"value":{"type":"percent","Text":"0.323370742333792"}},"neighborhood":{"value":{"type":"percent","Text":"0.392563567005895"}},"nation":{"value":{"type":"percent","Text":"0.313623902816284"}}},"name":{"Text":"Homes With Kids"}},{"values":{"city":{"value":{"Text":"2.83"}},"neighborhood":{"value":{"Text":"3.12509169641722"}},"nation":{"value":{"Text":"2.58883240001203"}}},"name":{"Text":"Average Household Size"}},{"values":{"city":{"value":{"Text":"30.50620080937762"}},"neighborhood":{"value":{"Text":"33.12401815367537"}},"nation":{"value":{"Text":"26.375545725891282"}}},"name":{"Text":"Average Commute Time (Minutes)"}}]},"name":{"Text":"People Data"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.046518409059168"},"name":{"Text":">=70s"}},{"value":{"type":"percent","Text":"0.194359506273126"},"name":{"Text":"0s"}},{"value":{"type":"percent","Text":"0.14456236096734"},"name":{"Text":"10s"}},{"value":{"type":"percent","Text":"0.17307610334621"},"name":{"Text":"20s"}},{"value":{"type":"percent","Text":"0.170846521112171"},"name":{"Text":"30s"}},{"value":{"type":"percent","Text":"0.126503839978541"},"name":{"Text":"40s"}},{"value":{"type":"percent","Text":"0.0880524181936073"},"name":{"Text":"50s"}},{"value":{"type":"percent","Text":"0.0560808410698363"},"name":{"Text":"60s"}}]},"name":{"Text":"Census Summary-AgeDecade"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.0450672877329415"},"name":{"Text":"<10min"}},{"value":{"type":"percent","Text":"0.121051651493561"},"name":{"Text":">=60min"}},{"value":{"type":"percent","Text":"0.22959738423589"},"name":{"Text":"10-20min"}},{"value":{"type":"percent","Text":"0.186747291257352"},"name":{"Text":"20-30min"}},{"value":{"type":"percent","Text":"0.244821023256296"},"name":{"Text":"30-45min"}},{"value":{"type":"percent","Text":"0.172715362023959"},"name":{"Text":"45-60min"}}]},"name":{"Text":"Census Summary-CommuteTime"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.607436432994105"},"name":{"Text":"NoKids"}},{"value":{"type":"percent","Text":"0.392563567005895"},"name":{"Text":"WithKids"}}]},"name":{"Text":"Census Summary-Household"}},{"data":{"attribute":[{"value":{"type":"percent","Text":"0.0599989185393609"},"name":{"Text":"Divorced-Female"}},{"value":{"type":"percent","Text":"0.0249471301888779"},"name":{"Text":"Divorced-Male"}},{"value":{"type":"percent","Text":"0.247580088008653"},"name":{"Text":"Married-Female"}},{"value":{"type":"percent","Text":"0.245740837928742"},"name":{"Text":"Married-Male"}},{"value":{"type":"percent","Text":"0.175584818056711"},"name":{"Text":"Single-Female"}},{"value":{"type":"percent","Text":"0.201457805106603"},"name":{"Text":"Single-Male"}},{"value":{"type":"percent","Text":"0.0353835129791575"},"name":{"Text":"Widowed-Female"}},{"value":{"type":"percent","Text":"0.00930688919189388"},"name":{"Text":"Widowed-Male"}}]},"name":{"Text":"Census Summary-RelationshipStatus"}}]}}]},"links":{"recentlySold":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/sold/"},"affordability":{"Text":"http://www.zillow.com/local-info/CA-Los-Angeles/Highland-Park-home-value/r_115609/"},"people":{"Text":"http://www.zillow.com/local-info/CA-Los-Angeles/Highland-Park-people/r_115609/"},"forSaleByOwner":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/fsbo/"},"foreclosures":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/pmf_pt/"},"homesandrealestate":{"Text":"http://www.zillow.com/local-info/CA-Los-Angeles/Highland-Park-homes/r_115609/"},"main":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/"},"forSale":{"Text":"http://www.zillow.com/highland-park-los-angeles-ca/"}},"charts":{"chart":[{"url":{"Text":"http://www.zillow.com/app?chartType=affordability_avgCondoValue&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Median Condo Value"}},{"url":{"Text":"http://www.zillow.com/app?chartType=affordability_avgHomeValue&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Median Home Value"}},{"url":{"Text":"http://www.zillow.com/app?chartType=affordability_pricePerSqft&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Dollars Per Square Feet"}},{"url":{"Text":"http://www.zillow.com/app?chartType=affordability_ZindexByDistribution&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"deprecated":"true","Text":"Zillow Home Value Index Distribution"}},{"url":{"Text":"http://www.zillow.com/app?chartType=home_homeType&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Home Type"}},{"url":{"Text":"http://www.zillow.com/app?chartType=home_ownVsRent&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"deprecated":"true","Text":"Owners vs. Renters"}},{"url":{"Text":"http://www.zillow.com/app?chartType=home_homeSize&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Home Size in Square Feet"}},{"url":{"Text":"http://www.zillow.com/app?chartType=home_yearBuilt&graphType=barChart&regionId=115609&regionType=8&service=chart"},"name":{"Text":"Year Built"}}]}},"message":{"text":{"Text":"Request successfully processed"},"code":{"Text":"0"}},"xsi":"urn:x-prefix:xsi"}}]}
	  , mm = r.avm        .stat       .autoEst   ||""
	  , ms = r.avm        .stat       .sdPop     ||"" , ml=mm?mm-(ms*S):0 , mh=mm?parseInt(mm,10)+parseInt((ms*S),10):0
   /* , cm = r.avm.dataset.coreLogic  .estimate  ||""
	  , cl = r.avm.dataset.coreLogic  .low       ||""
	  , ch = r.avm.dataset.coreLogic  .high      ||""
   */ , hm = r.avm.dataset.homeSnap   .estimate  ||""
	  , hl = r.avm.dataset.homeSnap   .low       ||""
	  , hh = r.avm.dataset.homeSnap   .high      ||""
	  , zm = r.avm.dataset.zillow     .estimate  ||""
	  , zl = r.avm.dataset.zillow     .searchresults.response.results.result.zestimate.valuationRange.low .Text   ||""
	  , zh = r.avm.dataset.zillow     .searchresults.response.results.result.zestimate.valuationRange.high.Text   ||""
	  , tm = r.avm.dataset.trulia     .estimate  ||"" , tl=tm?tm-(ms*R):0 , th=tm?parseInt(tm,10)+parseInt((ms*R),10):0
	  , dm = r.avm.dataset.dataQuick  .estimate  ||""
	  , dl = r.avm.dataset.dataQuick  .low       ||""
	  , dh = r.avm.dataset.dataQuick  .high      ||""
	  , sm = r.avm.dataset.smartZip   .estimate  ||""
	  , sl = r.avm.dataset.smartZip   .low       ||""
	  , sh = r.avm.dataset.smartZip   .high      ||""
	  , em = r.avm.dataset.eppraisal  .estimate  ||""
	  , el = r.avm.dataset.eppraisal  .low       ||""
	  , eh = r.avm.dataset.eppraisal  .high      ||""
	  , rm = r.avm.dataset.realEstate .estimate  ||"" , rl=rm?rm-(ms*R):0 , rh=rm?parseInt(rm,10)+parseInt((ms*R),10):0
	  ; out.options={title:"Dashboard for "+r.address.full/*5115 Longfellow St, Los Angeles, CA 90042"*/,isStacked:true,legend:{position:"none"/*"top"*/},series:{0:{"color":"transparent"},1:{"color":"#428bca"},2:{"color":"#428bca"}},intervals:{"lineWidth":1,"barWidth":0.7/*0.618="Golden Ratio"*/}}//,theme:"maximized",
	  , out.dataBar   = [ [ "Source"     , "Estimate"    , "Low range"     , { role  : "style" }                               , "High range"    , { role  : "style" }                               ]
                     // , [ "Median"     , 433844-110491 , 110491          , "stroke-width:1;stroke-color:white"               , 110491          , "stroke-width:1;stroke-color:white"               ]
                        , [ "Median"     , ml /*mm-ms*/  , ms*S            , "stroke-width:1;stroke-color:white"               , ms*S            , "stroke-width:1;stroke-color:white"               ]
                     // , [ "CoreLogic"  , cl            , cm    - cl      , "stroke-width:1;stroke-color:white;color:#cccccc" , ch    - cm      , "stroke-width:1;stroke-color:white;color:#cccccc" ] // CoreLogic must be added later after we figure out the scrape
                        , [ "HomeSnap"   , hl            , hm    - hl      , "stroke-width:1;stroke-color:white;color:#cccccc" , hh    - hm      , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                     // , [ "Zillow"     , 597220        , 628653-597220   , "stroke-width:1;stroke-color:white;color:#cccccc" , 660086-628653   , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                        , [ "Zillow"     , zl            , zm    - zl      , "stroke-width:1;stroke-color:white;color:#cccccc" , zh    - zm      , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                     // , [ "Trulia"     , 509000-110491 , 110491          , "stroke-width:1;stroke-color:white;color:#cccccc" , 110491          , "stroke-width:1;stroke-color:white;color:#cccccc" ] // If no range, use populastion stdDev
                        , [ "Trulia"     , tl /*tm-ms*/  , tm    - tl/*ms*/, "stroke-width:1;stroke-color:white;color:#cccccc" , th    - tm/*ms*/, "stroke-width:1;stroke-color:white;color:#cccccc" ] // If no range, use populastion stdDev
                     // , [ "DataQuick"  , 396149        , 511356-396149   , "stroke-width:1;stroke-color:white;color:#cccccc" , 626562-511356   , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                        , [ "DataQuick"  , dl            , dm    - dl      , "stroke-width:1;stroke-color:white;color:#cccccc" , dh    - dm      , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                     // , [ "SmartZip"   , 300104        , 326200-300104   , "stroke-width:1;stroke-color:white;color:#cccccc" , 352296-326200   , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                        , [ "SmartZip"   , sl            , sm    - sl      , "stroke-width:1;stroke-color:white;color:#cccccc" , sh    - sm      , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                     // , [ "Eppraisal"  , 304884        , 358687-304884   , "stroke-width:1;stroke-color:white;color:#cccccc" , 412490-358687   , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                        , [ "Eppraisal"  , el            , em    - el      , "stroke-width:1;stroke-color:white;color:#cccccc" , eh    - em      , "stroke-width:1;stroke-color:white;color:#cccccc" ]
                     // , [ "RealEstate" , 347631-110491 , 110491          , "stroke-width:1;stroke-color:white;color:#cccccc" , 110491          , "stroke-width:1;stroke-color:white;color:#cccccc" ]]// If no range, use populastion stdDev
                        , [ "RealEstate" , rl /*rm-ms*/  , rm    - rl/*ms*/, "stroke-width:1;stroke-color:white;color:#cccccc" , rh    - rm/*ms*/, "stroke-width:1;stroke-color:white;color:#cccccc" ]]// If no range, use populastion stdDev
      , out.dataTable = [ [ "Source"     , "Estimate"    , "Low range"                                                         , "High range"                                                        ]
                     // , [ "Median"     , 433844        , 433844-110491                                                       , 433844+110491                                                       ]
                        , [ "Median"     , mm            , ml                                                                  , mh                                                                  ]
                     // , [ "CoreLogic"  , cm            , cl  CoreLogic must be added later after we figure out the scrape    , ch                                                                  ]
                        , [ "HomeSnap"   , hm            , hl                                                                  , hh                                                                  ]
                     // , [ "Zillow"     , 628653        , 597220                                                              , 660086                                                              ]
                        , [ "Zillow"     , zm            , zl                                                                  , zh                                                                  ]
                     // , [ "Trulia"     , 509000        , 509000-110491                                                       , 509000+110491                                                       ] //,  "color : #428bca"  ] // If no range, use populastion stdDev
                        , [ "Trulia"     , tm            , tl                                                                  , th                                                                  ] //,  "color : #428bca"  ] // If no range, use populastion stdDev
                     // , [ "DataQuick"  , 511356        , 396149                                                              , 626562                                                              ] //,  "color : #428bca"  ] // Bootstrap Colors: @brand-primary:#428bca http://getbootstrap.com/customize/#less-variables
                        , [ "DataQuick"  , dm            , dl                                                                  , dh                                                                  ] //,  "color : #428bca"  ]
                     // , [ "SmartZip"   , 326200        , 300104                                                              , 352296                                                              ] //,  "color : #428bca"  ]
                        , [ "SmartZip"   , sm            , sl                                                                  , sh                                                                  ] //,  "color : #428bca"  ]
                     // , [ "Eppraisal"  , 358687        , 304884                                                              , 412490                                                              ] //,  "color : #428bca"  ]
                        , [ "Eppraisal"  , em            , el                                                                  , eh                                                                  ] //,  "color : #428bca"  ]
                     // , [ "RealEstate" , 347631        , 347631-110491                                                       , 347631+110491                                                       ]]//,  "color : #428bca"  ] // If no range, use populastion stdDev
                        , [ "RealEstate" , rm            , rl                                                                  , rh                                                                  ]]//,  "color : #428bca"  ] // If no range, use populastion stdDev
	  , out.dataGauge = [["Label"    ,                        "Value"                                                                                                                                                                                                               ]
	                    ,["Market"   , function(){try{var x = 10*n[0].mktHealth                                                                                                                                                     ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error MSUNi: "+e.message);return 0}}()]
	                    ,["Value"    , function(){try{var x = r.avm.dataset.homeSnap.homeScore                                                                                                                                      ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error TaFxH: "+e.message);return 0}}()]
						,["Investor" , function(){try{var x = r.avm.dataset.homeSnap.investorScore                                                                                                                                  ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error PBGep: "+e.message);return 0}}()]
						,["Income"   , function(){try{var x = LibraryjsUtil.getIncomePercentile(n[1].demographics.response.pages.page[2].tables.table[0].data.attribute[0].values.neighborhood/*.city,.nation*/.value.Text)         ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error i6C22: "+e.message);return 0}}()]
						,["Nhood"    , function(){try{var x = LibraryjsUtil.normalizeRatio(r.avm.dataset.zillow.estimate,n[0].indexSubject)                                                                                         ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error A9MKD: "+e.message);return 0}}()]
						,["Forecl"   , function(){try{var x = LibraryjsUtil.normalizeRatio(n[0].fcVal0,n[0].fcVal2)                                                                                                                 ;return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error SXBSp: "+e.message);return 0}}()]
						,["Section"  , function(){try{var x = LibraryjsUtil.percentile(n[0].indexSubject,function(){var out=[],i=10;while(i--){var str="nb"+i+"price";if(n[0][str]==1*n[0][str]){out.push(n[0][str])}}return out}());return LibraryjsUtil.isNumber(x)?x:0}catch(e){Logger.log("Error iN0xv: "+e.message);return 0}}()]
						]
	  , out.link = r.link;
    LibraryjsUtil.dbParse({verb:"post",project:"argenta",className:"avmResult",ob:out})
	return out}
function getEmailReport(){LibraryjsUtil.getEmailReport()}
-------------------------------------- form.html (a template kit for implementing forms; must be unpacked) --------------------------------------
function processForm(formObject){var formBlob=formObject.myFile,driveFile=DriveApp.createFile(formBlob);return driveFile.getUrl()} // Goes in Code.gs // Reference: https://developers.google.com/apps-script/guides/html-service-communication#forms
<form id="myForm"><input name="myFile" type="file"><input type="button" value="Submit" onclick="google.script.run.withSuccessHandler(updateUrl).processForm(this.parentNode);this.parentNode.reset()"></form><div id="output"></div><script>function updateUrl(url){document.getElementById("output").innerHTML='<a href="'+url+'">Got it!</a>'}</script><!--Goes in index.html; Reference: https://developers.google.com/apps-script/guides/html/communication#forms-->
-------------------------------------- home.html --------------------------------------
<!DOCTYPE html><html><head>
    <meta charset="utf-8"/> <!--Improve search box: http://view.jquerymobile.com/1.4.0/demos/controlgroup/#Textinputs -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> <!-- Latest compiled and minified CSS --> <!-- http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css --> <!-- Color definitions: http://getbootstrap.com/customize/#colors | Blue:#428bca(hover:#3071a9) -->
<!--<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"> <!-- Optional theme -->
<!--<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css"> <!-- Google styles | Reference: https://developers.google.com/apps-script/add-ons/css -->
<!--<link rel="stylesheet" href="https://googledrive.com/host/0B1LVOoV_2dFtMzM0LXE2QTU4b1E"><!--Tables-->
    <style>
    /*  form     {xbackground:grey;padding:6px;xborder:2px solid #DDDDDD;border-radius:8px;}
        html     {text-align:center;font-family:arial;font-size:100%;color:#888888;}
        legend   {color:#888888;xtext-align:left}
	    table    {border-collapse:separate;border-spacing:15px;}
	    td       {color:#888888;vertical-align:top;text-align:center;padding:20px;border-radius:30px;border:8px solid #000000}
	    col-sm-1 {padding:10px}
	    sup      {font-style:italic;text-decoration:underline}
    */  input    {padding:7px 10px;border-radius:5px;margin-bottom:3px;xcolor-blue-button-primary:#428bca;xcolor-blue-button-hover:#3071a9;xcolor:#006dcc;xcolor:#0044cc;xcolor:#3e0901;xheight:100px;xfont-size:150%;xborder:5px solid #3e0901;}
    </style>
</head>
<body><div style="width:65%;margin:auto;text-align:center">
    <form id="research"><!--References: https://developers.google.com/apps-script/guides/html-service-communication#forms https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <input type="text" style="width:100%" id="address" name="address" placeholder="Enter address" title="e.g., 123 Main St, Los Angeles, CA 90210" onkeyup="updateLink()"> <!-- Note: Must use "onkeyup," otherwise "onkeypress" or "onkeydown" captures input before character is registered; so last character is omitted; usually the last digit of the zip code. -->
	<br><a id="reportLink"><input type="button" class="btn btn-block btn-primary" xclass="blue|#428bca" value="Get free report" xonclick="myFunction()"></a> <!-- Reference: http://stackoverflow.com/questions/5462251/button-width-in-css3 -->
	</form><!--<br><div id="result"></div>--></div>
<script>
function updateLink(){document.getElementById("reportLink").href="https://googledrive.com/host/0B1LVOoV_2dFtNUZuRTZ6T0pPT00?a="+encodeURIComponent(document.getElementById("address").value)}
//function onFailure(e){alert(e.message)}function onSuccess(str){document.getElementById("result").innerHTML=str}//iframe doesn't work bc get request is only sent on page load. So we have the user click a link. //"<iframe src='https://googledrive.com/host/0B1LVOoV_2dFtNUZuRTZ6T0pPT00' width='1200' height='1200'></iframe>"}//alert(/*"Input received!"* /document.getElementById("address").value)}
//function myFunction(){document.getElementById("result").innerHTML="<img src='https://lh5.googleusercontent.com/-WsUsFefoGLQ/U_1TvMrrfvI/AAAAAAAAMnI/PDrmxMB9aZ4/s800/load666666.gif'>";
//    google.script.run.withFailureHandler(onFailure).withSuccessHandler(onSuccess).avmReportGetLink(this.parentNode)}//Don't use document.getElementById("address").value} because it will not return the entire form (only the address datafield) and if the code is copy/pasted in the future, it will create a bug if the entire form is needed//Date()} //xonclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_registerSeller(this.parentNode)" // Note: Use this.parentNode to retrieve all the fields in a form; to get only a single field, use something like: document.getElementById("address").value //function numberWithCommas(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");return parts.join(".")} // http://stackoverflow.com/questions/2901102/how_to_print_a_number_with_commas_as_thousands_separators_in_javascript // function test(){var arr=[88,99,1000,1005,1000050,10500000,10500000.123456],i=arr.length;while(i__){Logger.log(numberWithCommas(arr[i]))}}
</script></body></html>
-------------------------------------- signup.html -------------------------------------- 8/24/2014, 8/26/2014 To add features, see file: Bootstrap_Argenta_Signup (Undeprecated) Features: info and question glyphs, formatted tooltips and popovers, iframe for multiple pages on single Google Sites page
<!DOCTYPE html><html><head>
    <meta charset="utf-8"/> <!--Improve search box: http://view.jquerymobile.com/1.4.0/demos/controlgroup/#Textinputs-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> <!-- Latest compiled and minified CSS --> <!-- http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css -->
<!--<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"> <!-- Optional theme -->
<!--<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css"> <!-- Google styles | Reference: https://developers.google.com/apps-script/add-ons/css -->
<!--<link rel="stylesheet" href="https://googledrive.com/host/0B1LVOoV_2dFtMzM0LXE2QTU4b1E"><!--Tables-->
    <style>
    /*  form     {xbackground:grey;padding:6px;xborder:2px solid #DDDDDD;border-radius:8px;}
	    html     {text-align:center;font-family:arial;font-size:100%;color:#888888;}
        legend   {color:#888888;xtext-align:left}
	    table    {border-collapse:separate;border-spacing:15px;}
	    td       {color:#888888;vertical-align:top;text-align:center;padding:20px;border-radius:30px;border:8px solid #000000}
	    col-sm-1 {padding:10px}
	    sup      {font-style:italic;text-decoration:underline}
    */  input    {padding:7px 10px;border-radius:5px;xcolor:#006dcc;xcolor:#0044cc;xcolor:#3e0901;xheight:100px;xfont-size:150%;xborder:5px solid #3e0901;}
    </style>
</head>
<body><h1>Agents signup here</h1>
    <form id="myForm" class="form-inline" xclass="form-horizontal"> <!--References: https://developers.google.com/apps-script/guides/html-service-communication#forms https://developers.google.com/apps-script/guides/html-service-communication#user_objects-->
        <!--<fieldset><legend>Company information</legend>-->
		<div class="well"><h2 class="text-left">Registration Form <small>for agents to provide BPO services</small></h2>
		<div class="well"><h4 class="text-left">Your Contact Details</h4>
		    &nbsp;&nbsp;&nbsp;<input type="text" id="email" name="email" placeholder="Email" style="width:200px" title="Example: janedoe@example.com">
            &nbsp;&nbsp;&nbsp;<input type="text" id="name"  name="name"  placeholder="Name"  style="width:200px" title="Example: Jane Doe">
            &nbsp;&nbsp;&nbsp;<input type="text" id="phone" name="phone" placeholder="Phone" style="width:100px" title="Example: 2125551212">
            &nbsp;&nbsp;&nbsp;<input type="text" id="zip"   name="zip"   placeholder="Zip"   style="width: 70px" title="Example: 02139">
		</div>
		<!--</fieldset><fieldset><legend>Pricing</legend>-->
		<div class="well"><h4 class="text-left">BPO Pricing</h4>
		      &nbsp;&nbsp;&nbsp; Zone 1
		          <label class="sr-only" for="radius1">Radius</label><input type="text" size="1" id="radius1" name="radius1" placeholder="Miles" title="Radius in miles for zone 1. Example: 5">
                  <label class="sr-only" for="price1" >Price </label><input type="text" size="1" id="price1"  name="price1"  placeholder="Price" title="Price in dollars for zone 1. Example: 20">
		      &nbsp;&nbsp;&nbsp; Zone 2
		          <label class="sr-only" for="radius2">Radius</label><input type="text" size="1" id="radius2" name="radius2" placeholder="Miles" title="Radius in miles for zone 2. Example: 5">
                  <label class="sr-only" for="price2" >Price </label><input type="text" size="1" id="price2"  name="price2"  placeholder="Price" title="Price in dollars for zone 2. Example: 20">
		      &nbsp;&nbsp;&nbsp; Zone 3
		          <label class="sr-only" for="radius3">Radius</label><input type="text" size="1" id="radius3" name="radius3" placeholder="Miles" title="Radius in miles for zone 3. Example: 5">
                  <label class="sr-only" for="price3" >Price </label><input type="text" size="1" id="price3"  name="price3"  placeholder="Price" title="Price in dollars for zone 3. Example: 20">
		<!--</fieldset>-->
		</div></div>
    <input  type="button" class="btn btn-lg btn-block btn-primary" xclass="blue" onclick=           "myFunction()" value="Submit" xstyle="xtext-align:center;xbackground:#3e0901;xfont-size:100%;xcolor:white;xfont-weight:bold;xpadding:10px 20px;xborder-radius:999px;xdisplay:inline-block;xwidth:770px;" > <!-- Reference: http://stackoverflow.com/questions/5462251/button-width-in-css3 -->
    <input  type="button" class="btn btn-lg btn-block btn-default" xclass="grey" onclick="this.parentNode.reset()" value="Reset"  xstyle="xtext-align:center;xbackground:#3e0901;xfont-size:100%;xcolor:white;xfont-weight:bold;xpadding:10px 20px;xborder-radius:999px;xdisplay:inline-block;xwidth:770px;" >
	</form><br><br><br>
						<table class="table table-striped table-hover" xclass="CSSTableGenerator-gray">
                        <thead><th>Field A</th><th>Field B</th><th>Field C</th></thead>
						<tbody>
						<tr>
						  <td>100</td>
						  <td>200</td>
						  <td>300</td>
						</tr>
						<tr>
						  <td>400</td>
						  <td>500</td>
						  <td>600</td>
						</tr>
						<tr>
						  <td>700</td>
						  <td>800</td>
						  <td>900</td>
						</tr>
						</tbody>
						</table>
<div id="result"></div>
<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script> <!-- Latest compiled and minified JavaScript --> <!-- http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js -->
    <script type="text/javascript">
//$(function(){$("[rel='tooltip']").tooltip();});
//$(document).ready(function(){$("body").tooltip({selector:'[data-toggle=tooltip]'});});
//$('[data-toggle="tooltip"]').tooltip({"placement":"top","html":false,"animation":"true","delay":{"show":0,"hide":0}}); // References: http://jsfiddle.net/LhZpX/ http://stackoverflow.com/questions/18410922/bootstrap-3-0-popovers-and-tooltips
//$('#mark-info'    ).tooltip({"show":true,"placement":"left","title":"We let you specify three pricing zones around your center zip code. This optimizes your pricing flexibility to be more competitive for closer locations and recoup costs if you have to travel farther."});
//$('#mark-question').tooltip({"show":true,"placement":"left","title":"Pricing zones are defined by their distance around your home zone specified in the section labelled Contact Details"});
function onFailure(e){alert(e.message)}function onSuccess(str){document.getElementById("result").innerHTML=str}//iframe doesn't work bc get request is only sent on page load. So we have the user click a link. //"<iframe src='https://googledrive.com/host/0B1LVOoV_2dFtNUZuRTZ6T0pPT00' width='1200' height='1200'></iframe>"}//alert(/*"Input received!"* /document.getElementById("address").value)}
function myFunction(){//document.getElementById("result").innerHTML="<img src='https://lh4.googleusercontent.com/-S3rRVyRoXeA/U62uSnnsXLI/AAAAAAAAMA4/N10K1jdADPY/s800/ajax-loader.gif'>";
    google.script.run.withFailureHandler(onFailure).withSuccessHandler(onSuccess).receiveSignup(this.parentNode);this.parentNode.reset()}//**IMPORTANT**“this” gets the “name” property of the parent element, i.e., the form tag/element. In order to use the “this.parnentNote” method (as opposed to the document.getElementById() method) verify the form element has a proper “name” property. Otherwise, the function will fail “silently.”//document.getElementById("address").value}//Date()} //xonclick="google.script.run.withSuccessHandler(updateButton).withUserObject(this).processForm_registerSeller(this.parentNode)" // Note: Use this.parentNode to retrieve all the fields in a form; to get only a single field, use something like: document.getElementById("address").value //function numberWithCommas(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");return parts.join(".")} // http://stackoverflow.com/questions/2901102/how_to_print_a_number_with_commas_as_thousands_separators_in_javascript // function test(){var arr=[88,99,1000,1005,1000050,10500000,10500000.123456],i=arr.length;while(i__){Logger.log(numberWithCommas(arr[i]))}}
</script></body></html>